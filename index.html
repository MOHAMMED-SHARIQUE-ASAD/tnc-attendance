<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>THE NEW COLLEGE - University Management System</title>
    <!-- Google Sheets API Client Library -->
    <script src="https://apis.google.com/js/api.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: linear-gradient(135deg, #8B0000 0%, #B22222 100%);
            min-height: 100vh;
            color: #333;
            transition: background-color 0.3s ease, color 0.3s ease;
        }

        body.dark-mode {
            background: #121212;
        }

        body.dark-mode .login-card {
            background: #1e1e1e;
            color: #fff;
        }

        body.dark-mode .login-card input {
            background: #2d2d2d;
            color: #fff;
            border-color: #444;
        }

        body.dark-mode .role-btn {
            background: #2d2d2d;
            color: #fff;
            border-color: #444;
        }

        body.dark-mode .navbar,
        body.dark-mode .bottom-nav,
        body.dark-mode .menu-full,
        body.dark-mode .attendance-page,
        body.dark-mode .library-page,
        body.dark-mode .fees-page,
        body.dark-mode .timetable-page,
        body.dark-mode .mentor-page,
        body.dark-mode .tutorials-page,
        body.dark-mode .visits-page,
        body.dark-mode .account-page,
        body.dark-mode .departments-page,
        body.dark-mode .courses-page,
        body.dark-mode .student-home,
        body.dark-mode .mark-attendance-page,
        body.dark-mode .period-detail-card {
            background: #1e1e1e;
            color: #fff;
        }

        body.dark-mode .student-header h1,
        body.dark-mode .student-header p,
        body.dark-mode .card-header h3,
        body.dark-mode .attendance-tab,
        body.dark-mode .fees-tab,
        body.dark-mode .library-tab,
        body.dark-mode .book-title,
        body.dark-mode .book-author,
        body.dark-mode .stat-number,
        body.dark-mode .stat-label,
        body.dark-mode .detail-label,
        body.dark-mode .detail-value,
        body.dark-mode .department-card h3,
        body.dark-mode .department-stats span,
        body.dark-mode .course-card h4,
        body.dark-mode .course-code,
        body.dark-mode .period-selector label,
        body.dark-mode .student-checkbox label,
        body.dark-mode .period-detail-card h4,
        body.dark-mode .period-detail-card p {
            color: #fff;
        }

        body.dark-mode .no-class,
        body.dark-mode .no-result,
        body.dark-mode .hour-box,
        body.dark-mode .class-card,
        body.dark-mode .feedback-section,
        body.dark-mode .fees-tabs,
        body.dark-mode .library-tabs,
        body.dark-mode .book-card,
        body.dark-mode .visit-stats,
        body.dark-mode .recent-item,
        body.dark-mode .menu-grid-item,
        body.dark-mode .search-box input,
        body.dark-mode .attendance-tab,
        body.dark-mode .fees-tab,
        body.dark-mode .library-tab,
        body.dark-mode .course-item,
        body.dark-mode .month-btn,
        body.dark-mode .department-card,
        body.dark-mode .course-card,
        body.dark-mode .period-card,
        body.dark-mode .student-list-item,
        body.dark-mode .period-detail-card {
            background: #2d2d2d;
            color: #fff;
            border-color: #444;
        }

        body.dark-mode .see-all {
            color: #ff6b6b;
        }

        /* Login Page Styles */
        .login-container {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            padding: 20px;
        }

        .login-card {
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            width: 100%;
            max-width: 450px;
            padding: 40px;
            animation: slideUp 0.5s ease;
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .login-header {
            text-align: center;
            margin-bottom: 30px;
        }

        .college-logo {
            width: 120px;
            height: 120px;
            margin: 0 auto 20px;
            border-radius: 50%;
            overflow: hidden;
            box-shadow: 0 10px 30px rgba(139, 0, 0, 0.3);
            border: 3px solid #8B0000;
            background: white;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .college-logo img {
            width: 100%;
            height: 100%;
            object-fit: contain;
            padding: 10px;
        }

        .college-name {
            color: #8B0000;
            font-size: 28px;
            margin-bottom: 5px;
            font-weight: 700;
        }

        .college-tagline {
            color: #B22222;
            font-size: 18px;
            font-style: italic;
            margin-bottom: 10px;
            font-family: 'Times New Roman', serif;
        }

        .arabic-text {
            color: #8B0000;
            font-size: 24px;
            margin-bottom: 20px;
            font-family: 'Traditional Arabic', 'Times New Roman', serif;
            border-top: 2px solid #8B0000;
            border-bottom: 2px solid #8B0000;
            padding: 10px;
            background: #FFF0F0;
        }

        .arabic-text small {
            font-size: 14px;
            display: block;
            margin-top: 5px;
            color: #666;
            font-family: 'Segoe UI', sans-serif;
        }

        .role-selector {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-bottom: 30px;
        }

        .role-btn {
            padding: 10px 20px;
            border: 2px solid #e0e0e0;
            background: white;
            border-radius: 10px;
            cursor: pointer;
            font-size: 16px;
            transition: all 0.3s ease;
        }

        .role-btn.active {
            background: #8B0000;
            color: white;
            border-color: #8B0000;
        }

        .input-group {
            margin-bottom: 20px;
        }

        .input-group label {
            display: block;
            margin-bottom: 8px;
            color: #555;
            font-weight: 500;
        }

        .input-group input {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            font-size: 16px;
            transition: all 0.3s ease;
        }

        .input-group input:focus {
            outline: none;
            border-color: #8B0000;
            box-shadow: 0 0 0 3px rgba(139, 0, 0, 0.1);
        }

        .input-group .hint {
            font-size: 12px;
            color: #8B0000;
            margin-top: 5px;
            font-style: italic;
        }

        .login-btn {
            width: 100%;
            padding: 14px;
            background: linear-gradient(135deg, #8B0000 0%, #B22222 100%);
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.3s ease;
        }

        .login-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(139, 0, 0, 0.3);
        }

        /* Dashboard Styles */
        .dashboard {
            display: none;
            min-height: 100vh;
            background: #f5f5f5;
        }

        .dashboard.active {
            display: block;
        }

        /* Navbar */
        .navbar {
            background: white;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            padding: 10px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: fixed;
            width: 100%;
            top: 0;
            z-index: 1000;
        }

        .nav-left {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .back-btn-nav {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: #8B0000;
            display: none;
            transition: transform 0.2s ease;
        }

        .back-btn-nav:hover {
            transform: translateX(-3px);
        }

        .back-btn-nav.visible {
            display: block;
        }

        .nav-brand {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .nav-logo {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            overflow: hidden;
            border: 2px solid #8B0000;
            background: white;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .nav-logo img {
            width: 100%;
            height: 100%;
            object-fit: contain;
            padding: 5px;
        }

        .nav-brand h2 {
            color: #8B0000;
            font-size: 18px;
            margin: 0;
        }

        .nav-brand small {
            color: #B22222;
            font-size: 10px;
            display: block;
        }

        .nav-right {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .theme-toggle {
            font-size: 20px;
            cursor: pointer;
            color: #8B0000;
        }

        .menu-toggle {
            font-size: 24px;
            cursor: pointer;
            color: #8B0000;
        }

        /* Main Content */
        .main-content {
            margin-top: 60px;
            margin-bottom: 70px;
            padding: 20px;
            min-height: calc(100vh - 130px);
            overflow-y: auto;
        }

        /* Bottom Navigation */
        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            background: white;
            display: flex;
            justify-content: space-around;
            padding: 10px 0;
            box-shadow: 0 -2px 10px rgba(0,0,0,0.1);
            z-index: 1000;
        }

        .nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 5px;
            color: #666;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            flex: 1;
            padding: 5px;
        }

        .nav-item.active {
            color: #8B0000;
        }

        .nav-item span:first-child {
            font-size: 20px;
        }

        /* Full Page Menu */
        .menu-full {
            position: fixed;
            top: 60px;
            left: 0;
            width: 100%;
            height: calc(100vh - 130px);
            background: white;
            z-index: 999;
            overflow-y: auto;
            padding: 20px;
            display: none;
        }

        .menu-full.open {
            display: block;
        }

        .menu-full .search-box {
            margin-bottom: 20px;
        }

        .menu-full .search-box input {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #e0e0e0;
            border-radius: 25px;
            font-size: 14px;
        }

        .menu-section {
            margin-bottom: 25px;
        }

        .menu-section h3 {
            color: #8B0000;
            font-size: 16px;
            margin-bottom: 10px;
        }

        .menu-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
        }

        .menu-grid-item {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .menu-grid-item:hover {
            background: #f0f0f0;
            transform: translateY(-2px);
        }

        .menu-grid-item span:first-child {
            font-size: 24px;
        }

        .menu-grid-item span:last-child {
            font-size: 14px;
            color: #333;
        }

        .recent-section {
            margin-bottom: 20px;
        }

        .recent-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .recent-header h3 {
            color: #8B0000;
            font-size: 16px;
        }

        .clear-all {
            color: #8B0000;
            font-size: 13px;
            cursor: pointer;
        }

        .recent-item {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 10px;
            background: #f8f9fa;
            border-radius: 8px;
            margin-bottom: 8px;
            cursor: pointer;
        }

        .recent-item:hover {
            background: #f0f0f0;
        }

        /* Student Home Content */
        .student-home {
            max-width: 600px;
            margin: 0 auto;
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .student-header {
            margin-bottom: 5px;
        }

        .student-header h1 {
            color: #333;
            font-size: 22px;
            margin-bottom: 5px;
        }

        .student-header p {
            color: #666;
            font-size: 14px;
        }

        .hours-grid {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
            background: white;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
            cursor: pointer;
        }

        .hour-box {
            flex: 1;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 10px;
            text-align: center;
            border: 2px solid transparent;
            transition: all 0.3s ease;
        }

        .hour-box:hover {
            transform: scale(1.05);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .hour-box.present {
            background: #d4edda;
            border-color: #28a745;
        }

        .hour-box.absent {
            background: #f8d7da;
            border-color: #dc3545;
        }

        .hour-box.late {
            background: #fff3cd;
            border-color: #ffc107;
        }

        .hour-box.letoff {
            background: #cce5ff;
            border-color: #004085;
        }

        .hour-box .hour {
            color: #333;
            font-size: 14px;
            margin-bottom: 5px;
            font-weight: 600;
        }

        .hour-box .status {
            font-size: 12px;
            font-weight: 600;
        }

        .hour-box.present .status {
            color: #28a745;
        }

        .hour-box.absent .status {
            color: #dc3545;
        }

        .hour-box.late .status {
            color: #ffc107;
        }

        .hour-box.letoff .status {
            color: #004085;
        }

        /* Period Detail Card */
        .period-detail-card {
            background: white;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 15px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
            animation: slideDown 0.3s ease;
        }

        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .period-detail-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid #f0f0f0;
        }

        .period-detail-header h3 {
            color: #8B0000;
            font-size: 18px;
            font-weight: 600;
        }

        .period-detail-header .period-time {
            color: #666;
            font-size: 14px;
        }

        .period-detail-content {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .period-detail-row {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .period-detail-label {
            min-width: 100px;
            color: #666;
            font-size: 14px;
            font-weight: 500;
        }

        .period-detail-value {
            color: #333;
            font-size: 15px;
            font-weight: 500;
        }

        .period-detail-value.faculty {
            color: #8B0000;
            font-weight: 600;
        }

        .period-detail-value.status {
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 13px;
            font-weight: 600;
        }

        .period-detail-value.status.present {
            background: #d4edda;
            color: #28a745;
        }

        .period-detail-value.status.absent {
            background: #f8d7da;
            color: #dc3545;
        }

        .period-detail-value.status.late {
            background: #fff3cd;
            color: #856404;
        }

        .period-detail-value.status.letoff {
            background: #cce5ff;
            color: #004085;
        }

        .period-detail-course {
            margin-top: 10px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 10px;
        }

        .period-detail-course h4 {
            color: #333;
            font-size: 16px;
            margin-bottom: 5px;
        }

        .period-detail-course p {
            color: #666;
            font-size: 14px;
            margin-bottom: 3px;
        }

        .period-detail-course .course-code {
            color: #8B0000;
            font-size: 13px;
            font-weight: 600;
        }

        .class-card {
            background: white;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 15px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .class-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .class-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .class-title {
            color: #333;
            font-size: 16px;
            font-weight: 600;
        }

        .class-status {
            color: #28a745;
            font-size: 14px;
            font-weight: 600;
        }

        .faculty-name {
            color: #8B0000;
            font-size: 14px;
            font-weight: 500;
            margin-bottom: 5px;
        }

        .class-details {
            color: #666;
            font-size: 14px;
            margin-bottom: 5px;
        }

        .view-all-link {
            text-align: right;
            margin: 15px 0;
        }

        .view-all-link a {
            color: #8B0000;
            text-decoration: none;
            font-size: 14px;
            font-weight: 500;
        }

        .feedback-section {
            background: white;
            border-radius: 15px;
            padding: 20px;
            margin: 15px 0;
            text-align: center;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        }

        .feedback-section p {
            color: #666;
            font-size: 14px;
            margin-bottom: 10px;
        }

        .feedback-btn {
            background: linear-gradient(135deg, #8B0000 0%, #B22222 100%);
            color: white;
            border: none;
            padding: 10px 30px;
            border-radius: 25px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.3s ease;
        }

        .feedback-btn:hover {
            transform: translateY(-2px);
        }

        .favorites-nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: white;
            border-radius: 30px;
            padding: 10px 20px;
            margin: 15px 0;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        }

        .favorites-nav .title {
            color: #333;
            font-size: 16px;
            font-weight: 600;
        }

        .favorites-nav .actions {
            display: flex;
            gap: 20px;
        }

        .favorites-nav .actions span {
            color: #8B0000;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
        }

        .schedule-section {
            background: white;
            border-radius: 15px;
            padding: 20px;
            margin: 15px 0;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        }

        .schedule-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .schedule-header h3 {
            color: #333;
            font-size: 16px;
            font-weight: 600;
        }

        .schedule-date {
            color: #8B0000;
            font-size: 14px;
        }

        .schedule-item {
            display: flex;
            gap: 15px;
            padding: 15px 0;
            border-bottom: 1px solid #f0f0f0;
        }

        .schedule-item:last-child {
            border-bottom: none;
        }

        .schedule-time {
            font-weight: 600;
            color: #8B0000;
            min-width: 100px;
            font-size: 14px;
        }

        .schedule-details h4 {
            color: #333;
            font-size: 15px;
            margin-bottom: 3px;
        }

        .schedule-details p {
            color: #666;
            font-size: 13px;
        }

        .result-card {
            background: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .card-header h3 {
            color: #333;
            font-size: 16px;
            font-weight: 600;
        }

        .see-all {
            color: #8B0000;
            text-decoration: none;
            font-size: 13px;
        }

        .no-result {
            text-align: center;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 10px;
        }

        .no-result p {
            color: #666;
            font-size: 14px;
            margin-bottom: 5px;
        }

        .no-result small {
            color: #999;
            font-size: 12px;
        }

        .semester-card {
            background: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        }

        .semester-stats {
            display: flex;
            align-items: center;
            gap: 20px;
            margin-top: 10px;
        }

        .stats-details {
            flex: 1;
        }

        .stat-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            padding-bottom: 8px;
            border-bottom: 1px dashed #e0e0e0;
        }

        .stat-row:last-child {
            border-bottom: none;
        }

        .stat-label {
            color: #666;
            font-size: 13px;
        }

        .stat-value {
            color: #333;
            font-weight: 600;
            font-size: 13px;
        }

        .percentage-circle {
            width: 80px;
            height: 80px;
            background: #8B0000;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 20px;
            font-weight: bold;
            position: relative;
        }

        .percentage-circle::after {
            content: '%';
            font-size: 12px;
            position: absolute;
            top: 25px;
            right: 18px;
        }

        .notice-card {
            background: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        }

        .notice-content {
            text-align: center;
            padding: 20px;
        }

        .notice-icon {
            font-size: 30px;
            margin-bottom: 10px;
            opacity: 0.5;
        }

        .notice-content h4 {
            color: #333;
            font-size: 14px;
            margin-bottom: 5px;
        }

        .notice-content p {
            color: #999;
            font-size: 12px;
        }

        .events-card {
            background: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        }

        .events-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .events-header h3 {
            color: #333;
            font-size: 16px;
            font-weight: 600;
        }

        .event-item {
            display: flex;
            gap: 15px;
            padding: 12px 0;
            border-bottom: 1px solid #f0f0f0;
        }

        .event-item:last-child {
            border-bottom: none;
        }

        .event-date {
            width: 45px;
            text-align: center;
        }

        .event-date .day {
            color: #8B0000;
            font-size: 18px;
            font-weight: bold;
            line-height: 1;
        }

        .event-date .month {
            color: #666;
            font-size: 11px;
        }

        .event-details h4 {
            color: #333;
            font-size: 14px;
            margin-bottom: 3px;
        }

        .event-details p {
            color: #999;
            font-size: 12px;
        }

        /* Attendance Page */
        .attendance-page {
            background: white;
            border-radius: 20px;
            padding: 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .attendance-tabs {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
            border-bottom: 2px solid #f0f0f0;
            padding-bottom: 10px;
        }

        .attendance-tab {
            padding: 8px 20px;
            border: none;
            background: none;
            color: #666;
            font-size: 15px;
            font-weight: 500;
            cursor: pointer;
            border-radius: 20px;
            transition: all 0.3s ease;
        }

        .attendance-tab.active {
            background: #8B0000;
            color: white;
        }

        .course-list {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .course-item {
            padding: 15px;
            background: #f8f9fa;
            border-radius: 12px;
        }

        .course-header h3 {
            color: #333;
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 5px;
        }

        .course-faculty {
            color: #8B0000;
            font-size: 14px;
            margin-bottom: 5px;
        }

        .course-stats {
            display: flex;
            gap: 20px;
            font-size: 14px;
        }

        .course-stats span {
            color: #28a745;
            font-weight: 600;
        }

        .month-grid {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .month-btn {
            padding: 8px 15px;
            border: 1px solid #e0e0e0;
            background: white;
            border-radius: 20px;
            color: #666;
            font-size: 13px;
            cursor: pointer;
        }

        .month-btn.active {
            background: #8B0000;
            color: white;
            border-color: #8B0000;
        }

        .attendance-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
        }

        .attendance-table th {
            text-align: center;
            padding: 10px;
            background: #f8f9fa;
            color: #666;
            font-size: 13px;
        }

        .attendance-table td {
            text-align: center;
            padding: 8px;
            border-bottom: 1px solid #f0f0f0;
            font-size: 13px;
        }

        .status-present {
            color: #28a745;
            font-size: 18px;
        }

        .status-absent {
            color: #dc3545;
            font-size: 18px;
        }

        .status-late {
            color: #ffc107;
            font-size: 18px;
        }

        .status-letoff {
            color: #17a2b8;
            font-size: 18px;
        }

        .status-unmarked {
            color: #6c757d;
            font-size: 18px;
        }

        .status-buttons {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-top: 20px;
        }

        .status-btn {
            padding: 8px 15px;
            border: none;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 500;
            cursor: default;
        }

        .status-btn.present {
            background: #d4edda;
            color: #28a745;
        }

        .status-btn.absent {
            background: #f8d7da;
            color: #dc3545;
        }

        .status-btn.late {
            background: #fff3cd;
            color: #856404;
        }

        .status-btn.letoff {
            background: #cce5ff;
            color: #004085;
        }

        .status-btn.unmarked {
            background: #e2e3e5;
            color: #383d41;
        }

        .term-stats {
            margin-top: 20px;
        }

        .term-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .term-header h3 {
            color: #333;
            font-size: 18px;
        }

        .term-header span {
            color: #8B0000;
            font-size: 24px;
            font-weight: bold;
        }

        .term-period {
            background: #f8f9fa;
            padding: 10px;
            border-radius: 8px;
            text-align: center;
            margin-bottom: 20px;
            color: #666;
        }

        .term-table {
            width: 100%;
            border-collapse: collapse;
        }

        .term-table th {
            text-align: left;
            padding: 10px;
            background: #f8f9fa;
            color: #666;
            font-size: 13px;
        }

        .term-table td {
            padding: 10px;
            border-bottom: 1px solid #f0f0f0;
            font-size: 13px;
        }

        .term-table tr:last-child td {
            border-bottom: none;
            background: #f8f9fa;
            font-weight: 600;
        }

        /* Mark Attendance Page */
        .mark-attendance-page {
            background: white;
            border-radius: 20px;
            padding: 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            max-width: 800px;
            margin: 0 auto;
        }

        .period-selector {
            margin-bottom: 30px;
        }

        .period-selector h3 {
            color: #8B0000;
            font-size: 18px;
            margin-bottom: 15px;
        }

        .period-grid {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }

        .period-card {
            flex: 1;
            min-width: 100px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 12px;
            text-align: center;
            cursor: pointer;
            border: 2px solid transparent;
            transition: all 0.3s ease;
        }

        .period-card.selected {
            border-color: #8B0000;
            background: #fff0f0;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(139,0,0,0.1);
        }

        .period-card .period-number {
            font-size: 20px;
            font-weight: bold;
            color: #8B0000;
            margin-bottom: 5px;
        }

        .period-card .period-time {
            font-size: 13px;
            color: #666;
        }

        .course-selector {
            margin-bottom: 30px;
        }

        .course-selector h3 {
            color: #8B0000;
            font-size: 18px;
            margin-bottom: 15px;
        }

        .course-select {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            font-size: 14px;
            background: white;
        }

        .student-list {
            margin-bottom: 30px;
            max-height: 400px;
            overflow-y: auto;
        }

        .student-list-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .student-list-header h3 {
            color: #8B0000;
            font-size: 18px;
        }

        .student-list-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 10px;
            margin-bottom: 10px;
        }

        .student-info {
            flex: 1;
        }

        .student-info h4 {
            color: #333;
            font-size: 15px;
            margin-bottom: 3px;
        }

        .student-info p {
            color: #666;
            font-size: 13px;
        }

        .student-status {
            display: flex;
            gap: 8px;
        }

        .status-option {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 18px;
            background: white;
            border: 2px solid #e0e0e0;
        }

        .status-option.present.active {
            background: #d4edda;
            border-color: #28a745;
            color: #28a745;
        }

        .status-option.absent.active {
            background: #f8d7da;
            border-color: #dc3545;
            color: #dc3545;
        }

        .status-option.late.active {
            background: #fff3cd;
            border-color: #ffc107;
            color: #856404;
        }

        .status-option.letoff.active {
            background: #cce5ff;
            border-color: #004085;
            color: #004085;
        }

        .status-option:hover {
            transform: scale(1.1);
        }

        .mark-all-section {
            margin-bottom: 30px;
        }

        .mark-all-buttons {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .mark-all-btn {
            flex: 1;
            min-width: 100px;
            padding: 12px;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .mark-all-btn.present {
            background: #d4edda;
            color: #28a745;
            border: 2px solid #28a745;
        }

        .mark-all-btn.absent {
            background: #f8d7da;
            color: #dc3545;
            border: 2px solid #dc3545;
        }

        .mark-all-btn.late {
            background: #fff3cd;
            color: #856404;
            border: 2px solid #ffc107;
        }

        .mark-all-btn.letoff {
            background: #cce5ff;
            color: #004085;
            border: 2px solid #004085;
        }

        .mark-all-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 10px rgba(0,0,0,0.1);
        }

        .submit-attendance {
            display: flex;
            gap: 15px;
            justify-content: flex-end;
        }

        .submit-btn {
            padding: 12px 30px;
            background: #8B0000;
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .submit-btn:hover {
            background: #B22222;
            transform: translateY(-2px);
        }

        .cancel-btn {
            padding: 12px 30px;
            background: #6c757d;
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .cancel-btn:hover {
            background: #5a6268;
            transform: translateY(-2px);
        }

        /* Departments Page */
        .departments-page {
            background: white;
            border-radius: 20px;
            padding: 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .departments-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .department-card {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }

        .department-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(139, 0, 0, 0.2);
            border-color: #8B0000;
        }

        .department-card h3 {
            color: #8B0000;
            font-size: 18px;
            margin-bottom: 10px;
        }

        .department-stats {
            display: flex;
            justify-content: space-between;
            color: #666;
            font-size: 14px;
            margin-bottom: 10px;
        }

        .course-preview {
            margin-top: 10px;
        }

        .course-tag {
            display: inline-block;
            background: white;
            color: #555;
            padding: 4px 10px;
            border-radius: 15px;
            font-size: 12px;
            margin: 0 5px 5px 0;
        }

        .view-courses-btn {
            width: 100%;
            padding: 8px;
            background: white;
            border: none;
            border-radius: 8px;
            color: #8B0000;
            font-size: 13px;
            font-weight: 600;
            cursor: pointer;
            margin-top: 10px;
        }

        .view-courses-btn:hover {
            background: #8B0000;
            color: white;
        }

        .back-btn {
            background: none;
            border: none;
            color: #8B0000;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            margin-bottom: 20px;
            display: inline-flex;
            align-items: center;
            gap: 5px;
        }

        .back-btn:hover {
            text-decoration: underline;
        }

        .department-header {
            background: linear-gradient(135deg, #8B0000 0%, #B22222 100%);
            color: white;
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 20px;
        }

        .courses-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
        }

        .course-card {
            background: #f8f9fa;
            border-radius: 12px;
            padding: 20px;
            border-left: 4px solid #8B0000;
        }

        .course-card h4 {
            color: #333;
            font-size: 16px;
            margin-bottom: 5px;
        }

        .course-code {
            color: #8B0000;
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 5px;
        }

        .course-meta {
            display: flex;
            gap: 15px;
            margin-top: 10px;
            font-size: 13px;
            color: #666;
        }

        .badge {
            padding: 3px 8px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: 600;
            display: inline-block;
            margin-bottom: 10px;
        }

        .badge-ug {
            background: #e3f2fd;
            color: #1976d2;
        }

        .badge-pg {
            background: #f3e5f5;
            color: #7b1fa2;
        }

        .badge-mphil {
            background: #fff3e0;
            color: #f57c00;
        }

        .badge-phd {
            background: #e8f5e9;
            color: #388e3c;
        }

        /* Fees Page */
        .fees-page {
            background: white;
            border-radius: 20px;
            padding: 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .fees-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            border-bottom: 2px solid #f0f0f0;
            padding-bottom: 10px;
        }

        .fees-tab {
            padding: 8px 15px;
            border: none;
            background: none;
            color: #666;
            font-size: 14px;
            cursor: pointer;
            border-radius: 20px;
        }

        .fees-tab.active {
            background: #8B0000;
            color: white;
        }

        .fees-subtabs {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
        }

        .fees-subtab {
            padding: 8px 0;
            border: none;
            background: none;
            color: #666;
            font-size: 14px;
            cursor: pointer;
            border-bottom: 2px solid transparent;
        }

        .fees-subtab.active {
            color: #8B0000;
            border-bottom-color: #8B0000;
        }

        .due-amount {
            text-align: center;
            padding: 30px;
            background: #f8f9fa;
            border-radius: 12px;
            margin-bottom: 20px;
        }

        .due-amount h2 {
            color: #28a745;
            font-size: 24px;
            margin-bottom: 10px;
        }

        .due-amount p {
            color: #666;
            font-size: 16px;
        }

        .pay-btn {
            background: #8B0000;
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 25px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            margin-top: 15px;
        }

        .no-dues {
            text-align: center;
            padding: 40px;
            color: #666;
            font-size: 16px;
        }

        /* Library Page */
        .library-page {
            background: white;
            border-radius: 20px;
            padding: 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .library-tabs {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
            border-bottom: 2px solid #f0f0f0;
            padding-bottom: 10px;
        }

        .library-tab {
            padding: 8px 20px;
            border: none;
            background: none;
            color: #666;
            font-size: 15px;
            cursor: pointer;
            border-radius: 20px;
        }

        .library-tab.active {
            background: #8B0000;
            color: white;
        }

        .library-search {
            margin-bottom: 20px;
        }

        .library-search input {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #e0e0e0;
            border-radius: 25px;
            font-size: 14px;
        }

        .book-list {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .book-card {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 12px;
        }

        .book-title {
            color: #333;
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 5px;
        }

        .book-author {
            color: #666;
            font-size: 14px;
            margin-bottom: 3px;
        }

        .book-details {
            color: #999;
            font-size: 13px;
        }

        /* Library Visits Page */
        .visits-page {
            background: white;
            border-radius: 20px;
            padding: 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .visits-stats {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin-bottom: 30px;
        }

        .stat-box {
            text-align: center;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 12px;
        }

        .stat-number {
            color: #8B0000;
            font-size: 28px;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .stat-label {
            color: #666;
            font-size: 13px;
        }

        .current-status {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .status-indicator {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: #dc3545;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
        }

        .status-time {
            flex: 1;
        }

        .status-time .date {
            color: #333;
            font-size: 16px;
            font-weight: 600;
        }

        .status-time .time {
            color: #666;
            font-size: 14px;
        }

        /* Mentor Page */
        .mentor-page {
            background: white;
            border-radius: 20px;
            padding: 40px 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            text-align: center;
        }

        .mentor-page h2 {
            color: #8B0000;
            font-size: 22px;
            margin-bottom: 15px;
        }

        .mentor-page p {
            color: #666;
            font-size: 16px;
        }

        /* Timetable Page */
        .timetable-page {
            background: white;
            border-radius: 20px;
            padding: 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .timetable-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .timetable-header h3 {
            color: #333;
            font-size: 18px;
        }

        .day-order {
            color: #8B0000;
            font-size: 14px;
        }

        .date-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 10px;
            margin-bottom: 20px;
        }

        .date-box {
            padding: 10px;
            background: #f8f9fa;
            border-radius: 8px;
            text-align: center;
            font-size: 13px;
            color: #333;
        }

        /* Tutorials Page */
        .tutorials-page {
            background: white;
            border-radius: 20px;
            padding: 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .tutorials-search {
            margin-bottom: 20px;
        }

        .tutorials-search input {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #e0e0e0;
            border-radius: 25px;
            font-size: 14px;
        }

        /* My Account Page */
        .account-page {
            background: white;
            border-radius: 20px;
            padding: 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .account-header {
            text-align: center;
            margin-bottom: 30px;
        }

        .account-header h2 {
            color: #333;
            font-size: 22px;
            margin-bottom: 5px;
        }

        .account-header p {
            color: #666;
            font-size: 14px;
        }

        .account-section {
            margin-bottom: 25px;
        }

        .account-section h3 {
            color: #8B0000;
            font-size: 16px;
            margin-bottom: 10px;
            padding-bottom: 5px;
            border-bottom: 2px solid #f0f0f0;
        }

        .account-detail {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px dashed #f0f0f0;
        }

        .detail-label {
            color: #666;
            font-size: 14px;
        }

        .detail-value {
            color: #333;
            font-weight: 500;
            font-size: 14px;
        }

        .logout-btn-account {
            width: 100%;
            padding: 15px;
            background: #dc3545;
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            margin-top: 20px;
        }

        /* Notifications */
        .notification {
            position: fixed;
            top: 80px;
            right: 20px;
            padding: 12px 20px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.2);
            display: none;
            align-items: center;
            gap: 10px;
            z-index: 1500;
            border-left: 4px solid #8B0000;
            font-size: 13px;
        }

        .notification.show {
            display: flex;
        }

        .notification.success {
            border-left-color: #28a745;
        }

        .notification.error {
            border-left-color: #dc3545;
        }

        /* Footer */
        .college-footer {
            text-align: center;
            margin-top: 20px;
            padding: 15px;
            color: #666;
            font-size: 12px;
            border-top: 1px solid #e0e0e0;
        }

        .arabic-footer {
            font-family: 'Traditional Arabic', 'Times New Roman', serif;
            font-size: 16px;
            color: #8B0000;
            margin-bottom: 5px;
        }

        /* Stats Grid */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .stat-card {
            background: white;
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        }

        .stat-card .stat-title {
            color: #666;
            font-size: 13px;
            margin-bottom: 5px;
        }

        .stat-card .stat-value {
            color: #333;
            font-size: 24px;
            font-weight: bold;
        }

        .table-container {
            background: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
            margin-bottom: 20px;
        }

        .table-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            border-bottom: 2px solid #8B0000;
            padding-bottom: 10px;
        }

        .table-header h3 {
            color: #333;
            font-size: 18px;
            font-weight: 600;
        }

        .btn-primary {
            padding: 8px 16px;
            background: #8B0000;
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
        }

        .btn-primary:hover {
            background: #B22222;
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        th {
            text-align: left;
            padding: 12px 10px;
            background: #f8f9fa;
            color: #666;
            font-weight: 600;
        }

        td {
            padding: 10px;
            border-bottom: 1px solid #f0f0f0;
        }

        /* Loading Overlay */
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            color: white;
            font-size: 18px;
        }
        
        .loading-overlay.active {
            display: flex;
        }
        
        .loading-spinner {
            width: 50px;
            height: 50px;
            border: 5px solid #f3f3f3;
            border-top: 5px solid #8B0000;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-right: 15px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <!-- Loading Overlay -->
    <div id="loadingOverlay" class="loading-overlay">
        <div class="loading-spinner"></div>
        <div>Loading data from Google Sheets...</div>
    </div>

    <!-- Login Page -->
    <div id="loginPage" class="login-container">
        <div class="login-card">
            <div class="login-header">
                <div class="college-logo">
                    <img src="TNC.png" alt="THE NEW COLLEGE Logo" onerror="this.src='data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI4MCIgaGVpZ2h0PSI4MCIgdmlld0JveD0iMCAwIDgwIDgwIj48cmVjdCB3aWR0aD0iODAiIGhlaWdodD0iODAiIGZpbGw9IiM4QjAwMDAiLz48dGV4dCB4PSI0MCIgeT0iNDAiIGZvbnQtc2l6ZT0iMjAiIHRleHQtYW5jaG9yPSJtaWRkbGUiIGRvbWluYW50LWJhc2VsaW5lPSJtaWRkbGUiIGZpbGw9IndoaXRlIiBmb250LWZhbWlseT0iQXJpYWwsIHNhbnMtc2VyaWYiPlROQzwvdGV4dD48L3N2Zz4=';">
                </div>
                <h1 class="college-name">THE NEW COLLEGE</h1>
                <div class="college-tagline">Empowering Education, Enriching Lives</div>
                <div class="arabic-text">
                      
                    <br>
                    <small>"MY LORD! INCREASE ME IN KNOWLEDGE"</small>
                </div>
            </div>
            
            <div class="role-selector">
                <button class="role-btn active" onclick="setRole('student')">Student</button>
                <button class="role-btn" onclick="setRole('staff')">Staff</button>
                <button class="role-btn" onclick="setRole('admin')">Admin</button>
            </div>

            <form id="loginForm" onsubmit="handleLogin(event)">
                <div id="studentFields">
                    <div class="input-group">
                        <label> Register Number</label>
                        <input type="text" id="registerNumber" placeholder="Enter register number">
                    </div>
                    <div class="input-group">
                        <label> Password</label>
                        <input type="password" id="password" placeholder="Enter password">
                        <div class="hint">Password is your register number</div>
                    </div>
                </div>

                <div id="staffAdminFields" style="display: none;">
                    <div class="input-group">
                        <label> Email Address</label>
                        <input type="email" id="email" placeholder="Enter email">
                    </div>
                    <div class="input-group">
                        <label> Password</label>
                        <input type="password" id="adminPassword" placeholder="Enter password">
                    </div>
                </div>

                <button type="submit" class="login-btn">Login to Dashboard</button>
            </form>
        </div>
    </div>

    <!-- Dashboard -->
    <div id="dashboard" class="dashboard">
        <nav class="navbar">
            <div class="nav-left">
                <button class="back-btn-nav" id="backBtnNav" onclick="goBack()"></button>
                <div class="nav-brand">
                    <div class="nav-logo">
                        <img src="TNC.png" alt="TNC" onerror="this.src='data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0MCIgaGVpZ2h0PSI0MCIgdmlld0JveD0iMCAwIDQwIDQwIj48cmVjdCB3aWR0aD0iNDAiIGhlaWdodD0iNDAiIGZpbGw9IiM4QjAwMDAiLz48dGV4dCB4PSIyMCIgeT0iMjAiIGZvbnQtc2l6ZT0iMTIiIHRleHQtYW5jaG9yPSJtaWRkbGUiIGRvbWluYW50LWJhc2VsaW5lPSJtaWRkbGUiIGZpbGw9IndoaXRlIiBmb250LWZhbWlseT0iQXJpYWwsIHNhbnMtc2VyaWYiPlROQzwvdGV4dD48L3N2Zz4=';">
                    </div>
                    <div>
                        <h2>THE NEW COLLEGE</h2>
                        <small>Est. 1951 | Chennai</small>
                    </div>
                </div>
            </div>
            <div class="nav-right">
                <div class="theme-toggle" onclick="toggleTheme()"></div>
                <div class="menu-toggle" onclick="toggleMenu()"></div>
            </div>
        </nav>

        <!-- Full Page Menu -->
        <div class="menu-full" id="fullMenu">
            <div class="search-box">
                <input type="text" placeholder="Search" id="menuSearch" onkeyup="searchMenu(this.value)">
            </div>

            <div class="recent-section" id="recentSection">
                <div class="recent-header">
                    <h3>Recent</h3>
                    <span class="clear-all" onclick="clearRecent()">Clear all</span>
                </div>
                <div id="recentItems">
                    <div class="recent-item" onclick="navigateTo('libraryGo')">
                        <span></span>
                        <span>Library Go</span>
                    </div>
                    <div class="recent-item" onclick="navigateTo('attendance')">
                        <span></span>
                        <span>Attendance</span>
                    </div>
                </div>
            </div>

            <div class="menu-section">
                <h3>Menu</h3>
                <div class="menu-grid" id="menuGrid">
                    <!-- Menu items will be dynamically updated based on role -->
                </div>
            </div>
        </div>

        <!-- Main Content -->
        <div class="main-content" id="mainContent"></div>

        <!-- Bottom Navigation -->
        <div class="bottom-nav">
            <div class="nav-item" onclick="switchTab('home')">
                <span></span>
                <span>Home</span>
            </div>
            <div class="nav-item" onclick="switchTab('menu')">
                <span></span>
                <span>Menu</span>
            </div>
            <div class="nav-item" onclick="switchTab('profile')">
                <span></span>
                <span>Profile</span>
            </div>
        </div>

        <!-- College Footer -->
        <div class="college-footer">
            <div class="arabic-footer">  </div>
            <div>THE NEW COLLEGE | Established 1951 | Affiliated to University of Madras</div>
        </div>
    </div>

    <!-- Notification -->
    <div id="notification" class="notification">
        <span id="notificationIcon"></span>
        <span id="notificationMessage"></span>
    </div>

    <script>
        // ==================== YOUR GOOGLE SHEETS CONFIGURATION ====================
        // REPLACE THESE WITH YOUR ACTUAL VALUES!
        const SPREADSHEET_ID = '1PB8ukhX2QdL-t5bLAamGGwdWt3YKRVD7Gghll7RS8IM';
        const API_KEY = 'AIzaSyCH2Y_fFZ5fXnL8oOopgYC3E8FQdw61P0k';
        
        // Sheets names
        const SHEETS = {
            STUDENTS: 'Students',
            ATTENDANCE: 'Attendance',
            STAFF: 'Staff',
            COURSES: 'Courses'
        };

        // ==================== APPLICATION STATE ====================
        let currentUser = null;
        let currentRole = 'student';
        let currentTab = 'home';
        let menuOpen = false;
        let recentItems = ['Library Go', 'Attendance'];
        let selectedPeriod = 1;
        let selectedCourse = null;
        let attendanceData = {};
        let expandedPeriod = null;
        
        // Navigation History
        let navigationHistory = [];
        let currentPage = 'home';

        // ==================== ALL COMPUTER SCIENCE STUDENTS ====================
        const csStudents = [
            { reg: '2313181058101', name: 'M Abdul Muquthadir', password: '2313181058101' },
            { reg: '2313181058102', name: 'Abrar S', password: '2313181058102' },
            { reg: '2313181058103', name: 'Ahmed Thariq', password: '2313181058103' },
            { reg: '2313181058106', name: 'Akbar', password: '2313181058106' },
            { reg: '2313181058108', name: 'Ashwin R', password: '2313181058108' },
            { reg: '2313181058109', name: 'S Ibrahim', password: '2313181058109' },
            { reg: '2313181058110', name: 'Khader Sharieef I', password: '2313181058110' },
            { reg: '2313181058111', name: 'K Mohamed Sardhar', password: '2313181058111' },
            { reg: '2313181058112', name: 'F Mohamed Aahil', password: '2313181058112' },
            { reg: '2313181058113', name: 'Mohamed Aslam', password: '2313181058113' },
            { reg: '2313181058114', name: 'Mohamed Azeem M', password: '2313181058114' },
            { reg: '2313181058117', name: 'Mohamed Fowze', password: '2313181058117' },
            { reg: '2313181058119', name: 'S Mohammed Fahad', password: '2313181058119' },
            { reg: '2313181058120', name: 'Nithish M', password: '2313181058120' },
            { reg: '2313181058121', name: 'A Riyas Khan', password: '2313181058121' },
            { reg: '2313181058122', name: 'S Sameer Ahmed', password: '2313181058122' },
            { reg: '2313181058126', name: 'Shek Ameen A', password: '2313181058126' },
            { reg: '2313181058129', name: 'Wasim Khan F', password: '2313181058129' },
            { reg: '2313181058130', name: 'Zaheer Khan J', password: '2313181058130' },
            { reg: '2313181058131', name: 'A Zakir Ahamed', password: '2313181058131' },
            { reg: '2313181058132', name: 'L T Abubacker Siddiq', password: '2313181058132' },
            { reg: '2313181058135', name: 'Mohammed Abbas S', password: '2313181058135' },
            { reg: '2313181058136', name: 'Mohamed Ibrahim.K', password: '2313181058136' },
            { reg: '2313181058138', name: 'Mohammed Muzafar Shariff K', password: '2313181058138' },
            { reg: '2313181058139', name: 'Muhammad Sheriff', password: '2313181058139' },
            { reg: '2313181058140', name: 'Muhammadh Zaidh M', password: '2313181058140' },
            { reg: '2313181058142', name: 'Mohamed Basith S', password: '2313181058142' },
            { reg: '2313181058143', name: 'Mohammed Shoib Alam', password: '2313181058143' },
            { reg: '2313181058144', name: 'Shahulhameed', password: '2313181058144' },
            { reg: '2313181058146', name: 'Syed Sameer Sidiq S K', password: '2313181058146' },
            { reg: '2313181058147', name: 'N Salman Gurshid', password: '2313181058147' },
            { reg: '2313181058148', name: 'Mohamed Kaleel K', password: '2313181058148' },
            { reg: '2313181058149', name: 'K Ahamed Haneef', password: '2313181058149' },
            { reg: '2313181058150', name: 'Mohammed Sharique Asad', password: '2313181058150' },
            { reg: '2313181058151', name: 'Mohammed Saifullah.S', password: '2313181058151' },
            { reg: '2313181058153', name: 'Danish', password: '2313181058153' },
            { reg: '2313181058154', name: 'A Shajakhqn', password: '2313181058154' },
            { reg: '2313181058156', name: 'M A Aadil Hussain', password: '2313181058156' },
            { reg: '2313181058157', name: 'Harif Hussain', password: '2313181058157' },
            { reg: '2313181058158', name: 'U Ameer Khan', password: '2313181058158' },
            { reg: '2313181058159', name: 'Muheeb Basha H', password: '2313181058159' },
            { reg: '2313181058160', name: 'Habeeb Razeen', password: '2313181058160' },
            { reg: '2313181058161', name: 'S Mohamed Bilal', password: '2313181058161' }
        ];

        // ==================== STAFF MEMBERS ====================
        const staffMembers = [
            { name: 'Dr. P. Hakkim Divan Mydeen', email: 'p.hakkimdivanmydeen@thenewcollege.edu.in', password: 'staff', department: 'Computer Science', designation: 'Professor' },
            { name: 'Mr. S.A. Abdul Kadhar', email: 'sa.abdulkadhar@thenewcollege.edu.in', password: 'staff', department: 'Computer Science', designation: 'Assistant Professor' },
            { name: 'Mr. A. Ashraf Ali', email: 'a.ashrafali@thenewcollege.edu.in', password: 'staff', department: 'Computer Science', designation: 'Assistant Professor' },
            { name: 'Dr. G. Najeeb Ahmed', email: 'g.najeebahmed@thenewcollege.edu.in', password: 'staff', department: 'Computer Science', designation: 'Professor' },
            { name: 'Mr. M.M. Syed Sulaiman', email: 'mm.syedsulaiman@thenewcollege.edu.in', password: 'staff', department: 'Computer Science', designation: 'Associate Professor' },
            { name: 'Dr. J. Abdul Rasheedh', email: 'j.abdulrasheedh@thenewcollege.edu.in', password: 'staff', department: 'Computer Science', designation: 'Professor' },
            { name: 'Mr. N. Anver Hussain', email: 'n.anverhussain@thenewcollege.edu.in', password: 'staff', department: 'Computer Science', designation: 'Associate Professor' },
            { name: 'Dr. S. Sakthivel', email: 's.sakthivel@thenewcollege.edu.in', password: 'staff', department: 'Computer Science', designation: 'Professor' },
            { name: 'Dr. K. Tajudin', email: 'k.tajudin@thenewcollege.edu.in', password: 'staff', department: 'Computer Science', designation: 'Professor' },
            { name: 'Mr. H. Riaz Ahamed', email: 'h.riazahamed@thenewcollege.edu.in', password: 'staff', department: 'Computer Science', designation: 'Assistant Professor' },
            { name: 'Mr. Syed Usman Basha', email: 'syed.usmanbasha@thenewcollege.edu.in', password: 'staff', department: 'Computer Science', designation: 'Assistant Professor' },
            { name: 'Mr. A.M. Abdul Kuthus', email: 'am.abdulkuthus@thenewcollege.edu.in', password: 'staff', department: 'Computer Science', designation: 'Assistant Professor' },
            { name: 'Mr. Mohammed Arshad .F', email: 'mohammed.arshadf@thenewcollege.edu.in', password: 'staff', department: 'Computer Science', designation: 'Assistant Professor' },
            { name: 'Mr. M. Mohamed NagoorGani', email: 'm.mohamednagoorgani@thenewcollege.edu.in', password: 'staff', department: 'Computer Science', designation: 'Assistant Professor' },
            { name: 'Mr. S. Xavier Raj', email: 's.xavierraj@thenewcollege.edu.in', password: 'staff', department: 'Computer Science', designation: 'Assistant Professor' },
            { name: 'Mr. V.M. Mohamed Noorul Ameen', email: 'vm.mohamednoorulameen@thenewcollege.edu.in', password: 'staff', department: 'Computer Science', designation: 'Assistant Professor' },
            { name: 'Mr. P. M. H. Hameedudeen', email: 'pmh.hameedudeen@thenewcollege.edu.in', password: 'staff', department: 'Computer Science', designation: 'Assistant Professor' },
            { name: 'Mr. J. Mohammed Javeed Basha', email: 'j.mohammedjaveedbasha@thenewcollege.edu.in', password: 'staff', department: 'Computer Science', designation: 'Assistant Professor' },
            { name: 'Mr. N. Mohamed Niyas Ali', email: 'n.mohamedniyasali@thenewcollege.edu.in', password: 'staff', department: 'Computer Science', designation: 'Assistant Professor' },
            { name: 'Mr. I. Mohideen Basha', email: 'i.mohideenbasha@thenewcollege.edu.in', password: 'staff', department: 'Computer Science', designation: 'Assistant Professor' },
            { name: 'Mr. Aarif Ahmed', email: 'aarif.ahmed@thenewcollege.edu.in', password: 'staff', department: 'Computer Science', designation: 'Assistant Professor' }
        ];

        // ==================== COURSES ====================
        const courses = [
            { id: 1, code: '20BJM608', name: 'Programming in ASP.NET', faculty: 'M M Syed Sulaiman', totalHours: 50 },
            { id: 2, code: '20BJM609', name: 'Operating Systems', faculty: 'N Anver Hussain', totalHours: 57 },
            { id: 3, code: '20BJMP607', name: 'Programming in ASP.NET PRACTICAL  VII', faculty: 'Dr. S. SAKTHIVEL', totalHours: 65 },
            { id: 4, code: '20BJM610', name: 'Internet of Things', faculty: 'Dr. G NAJEEB AHMED', totalHours: 37 },
            { id: 5, code: '20BJMQ601', name: 'Mini Project', faculty: 'Dr. J. Abdul Rasheedh', totalHours: 35 }
        ];

        // ==================== ADMIN USER ====================
        const adminUser = {
            email: 'admin@thenewcollege.in',
            password: 'admin',
            name: 'Administrator'
        };

        // ==================== GOOGLE SHEETS API INITIALIZATION ====================
        let gapiInited = false;

        function showLoading() {
            document.getElementById('loadingOverlay').classList.add('active');
        }

        function hideLoading() {
            document.getElementById('loadingOverlay').classList.remove('active');
        }

        // Initialize Google API client
        function gapiLoaded() {
            gapi.load('client', initializeGapiClient);
        }

        async function initializeGapiClient() {
            await gapi.client.init({
                apiKey: API_KEY,
                discoveryDocs: ["https://sheets.googleapis.com/$discovery/rest?version=v4"],
            });
            gapiInited = true;
            console.log('Google Sheets API initialized');
            
            // Load data from sheets
            await loadAllDataFromSheets();
        }

        // ==================== DATA LOADING FROM GOOGLE SHEETS ====================
        async function loadAllDataFromSheets() {
            showLoading();
            try {
                await Promise.all([
                    loadStudentsFromSheet(),
                    loadStaffFromSheet(),
                    loadAttendanceFromSheet(),
                    loadCoursesFromSheet()
                ]);
                console.log('All data loaded from Google Sheets');
            } catch (error) {
                console.error('Error loading data from sheets:', error);
                showNotification('Error loading data. Using default data.', 'error');
            } finally {
                hideLoading();
            }
        }

        async function loadStudentsFromSheet() {
            try {
                const response = await gapi.client.sheets.spreadsheets.values.get({
                    spreadsheetId: SPREADSHEET_ID,
                    range: `${SHEETS.STUDENTS}!A:C`, // Columns: Register No, Name, Password
                });
                
                const rows = response.result.values || [];
                if (rows.length > 1) { // Skip header row
                    window.csStudents = [];
                    for (let i = 1; i < rows.length; i++) {
                        const row = rows[i];
                        if (row.length >= 3) {
                            window.csStudents.push({
                                reg: row[0],
                                name: row[1],
                                password: row[2]
                            });
                        }
                    }
                    console.log(`Loaded ${window.csStudents.length} students from sheet`);
                }
            } catch (error) {
                console.error('Error loading students:', error);
                window.csStudents = csStudents; // Fallback to default
            }
        }

        async function loadStaffFromSheet() {
            try {
                const response = await gapi.client.sheets.spreadsheets.values.get({
                    spreadsheetId: SPREADSHEET_ID,
                    range: `${SHEETS.STAFF}!A:E`, // Name, Email, Password, Department, Designation
                });
                
                const rows = response.result.values || [];
                if (rows.length > 1) {
                    window.staffMembers = [];
                    for (let i = 1; i < rows.length; i++) {
                        const row = rows[i];
                        if (row.length >= 5) {
                            window.staffMembers.push({
                                name: row[0],
                                email: row[1],
                                password: row[2],
                                department: row[3],
                                designation: row[4]
                            });
                        }
                    }
                    console.log(`Loaded ${window.staffMembers.length} staff from sheet`);
                }
            } catch (error) {
                console.error('Error loading staff:', error);
                window.staffMembers = staffMembers; // Fallback to default
            }
        }

        async function loadAttendanceFromSheet() {
            try {
                const response = await gapi.client.sheets.spreadsheets.values.get({
                    spreadsheetId: SPREADSHEET_ID,
                    range: `${SHEETS.ATTENDANCE}!A:G`, // Date, StudentID, Period, Status, Faculty, Course, Details
                });
                
                const rows = response.result.values || [];
                attendanceData = {}; // Reset
                
                if (rows.length > 1) {
                    for (let i = 1; i < rows.length; i++) {
                        const row = rows[i];
                        if (row.length >= 5) {
                            const date = row[0];
                            const studentId = row[1];
                            const period = row[2];
                            const status = row[3];
                            const faculty = row[4] || '';
                            const course = row[5] || '';
                            const details = row[6] || '';
                            
                            const key = `${studentId}_${date}_${period}`;
                            attendanceData[key] = status;
                            if (faculty) attendanceData[key + '_faculty'] = faculty;
                            if (course) attendanceData[key + '_course'] = course;
                            if (details) attendanceData[key + '_details'] = details;
                        }
                    }
                }
                console.log(`Loaded ${Object.keys(attendanceData).length} attendance records from sheet`);
            } catch (error) {
                console.error('Error loading attendance:', error);
            }
        }

        async function loadCoursesFromSheet() {
            try {
                const response = await gapi.client.sheets.spreadsheets.values.get({
                    spreadsheetId: SPREADSHEET_ID,
                    range: `${SHEETS.COURSES}!A:E`, // ID, Code, Name, Faculty, TotalHours
                });
                
                const rows = response.result.values || [];
                if (rows.length > 1) {
                    window.courses = [];
                    for (let i = 1; i < rows.length; i++) {
                        const row = rows[i];
                        if (row.length >= 5) {
                            window.courses.push({
                                id: parseInt(row[0]),
                                code: row[1],
                                name: row[2],
                                faculty: row[3],
                                totalHours: parseInt(row[4])
                            });
                        }
                    }
                    console.log(`Loaded ${window.courses.length} courses from sheet`);
                }
            } catch (error) {
                console.error('Error loading courses:', error);
                window.courses = courses; // Fallback to default
            }
        }

        // ==================== DATA SAVING TO GOOGLE SHEETS ====================
        async function saveAttendanceToSheet() {
            showLoading();
            try {
                // Get current data
                const response = await gapi.client.sheets.spreadsheets.values.get({
                    spreadsheetId: SPREADSHEET_ID,
                    range: `${SHEETS.ATTENDANCE}!A:G`,
                });
                
                const existingRows = response.result.values || [];
                
                // Prepare new rows
                const newRows = [];
                const today = new Date().toISOString().split('T')[0];
                
                for (const [key, status] of Object.entries(attendanceData)) {
                    if (key.includes('_') && !key.includes('_faculty') && !key.includes('_course') && !key.includes('_details')) {
                        const [studentId, date, period] = key.split('_');
                        
                        // Only save today's records that aren't already in sheet
                        if (date === today) {
                            // Check if this record already exists
                            let exists = false;
                            for (const row of existingRows) {
                                if (row[0] === date && row[1] === studentId && row[2] === period) {
                                    exists = true;
                                    break;
                                }
                            }
                            
                            if (!exists) {
                                newRows.push([
                                    date,
                                    studentId,
                                    period,
                                    status,
                                    attendanceData[key + '_faculty'] || '',
                                    attendanceData[key + '_course'] || '',
                                    attendanceData[key + '_details'] || ''
                                ]);
                            }
                        }
                    }
                }
                
                // Append new rows
                if (newRows.length > 0) {
                    await gapi.client.sheets.spreadsheets.values.append({
                        spreadsheetId: SPREADSHEET_ID,
                        range: `${SHEETS.ATTENDANCE}!A:G`,
                        valueInputOption: 'USER_ENTERED',
                        resource: {
                            values: newRows
                        }
                    });
                    console.log(`Saved ${newRows.length} attendance records to sheet`);
                    showNotification('Attendance saved to Google Sheets!', 'success');
                } else {
                    showNotification('No new records to save', 'info');
                }
            } catch (error) {
                console.error('Error saving attendance:', error);
                showNotification('Error saving to Google Sheets', 'error');
            } finally {
                hideLoading();
            }
        }

        // ==================== GOOGLE SHEETS INITIALIZATION ON PAGE LOAD ====================
        window.onload = function() {
            gapiLoaded();
            loadSession();
        };

        // ==================== SESSION MANAGEMENT ====================
        function loadSession() {
            const savedUser = localStorage.getItem('currentUser');
            const savedRole = localStorage.getItem('currentRole');
            
            if (savedUser) {
                currentUser = JSON.parse(savedUser);
                currentRole = savedRole || 'student';
                
                document.getElementById('loginPage').style.display = 'none';
                document.getElementById('dashboard').classList.add('active');
                
                updateMenuForRole();
                document.getElementById('userName').textContent = currentUser.name;
                const initials = currentUser.name.split(' ').map(n => n[0]).join('').substring(0, 2).toUpperCase();
                document.getElementById('userAvatar').textContent = initials;
                
                if (currentRole === 'student') {
                    showStudentHome();
                } else {
                    showStaffAdminDashboard();
                }
            }
        }

        function saveSession() {
            if (currentUser) {
                localStorage.setItem('currentUser', JSON.stringify(currentUser));
                localStorage.setItem('currentRole', currentRole);
            }
        }

        function clearSession() {
            localStorage.removeItem('currentUser');
            localStorage.removeItem('currentRole');
            currentUser = null;
        }

        // ==================== NAVIGATION ====================
        function navigateToPage(page, pageData = null) {
            if (currentPage === page) return;
            
            if (currentPage && currentPage !== 'home') {
                navigationHistory.push({
                    page: currentPage,
                    data: currentPageData
                });
            }
            
            currentPage = page;
            currentPageData = pageData;
            
            document.getElementById('backBtnNav').classList.add('visible');
            
            switch(page) {
                case 'markAttendance':
                    showMarkAttendance();
                    break;
                case 'departments':
                    showDepartments();
                    break;
                case 'courses':
                    showAllCourses();
                    break;
                case 'students':
                    showStudents();
                    break;
                case 'faculty':
                    showFaculty();
                    break;
                case 'libraryGo':
                    showLibraryGo();
                    break;
                case 'attendance':
                    showAttendance();
                    break;
                case 'fees':
                    showFees();
                    break;
                case 'myAccount':
                    showMyAccount();
                    break;
                case 'tutorials':
                    showTutorials();
                    break;
                case 'studentTimetable':
                    showStudentTimetable();
                    break;
                case 'myMentor':
                    showMyMentor();
                    break;
                case 'libraryVisits':
                    showLibraryVisits();
                    break;
                case 'onlinePayment':
                    showOnlinePayment();
                    break;
                case 'feePayment':
                    showFeePayment();
                    break;
                case 'departmentCourses':
                    if (pageData) {
                        showDepartmentCourses(pageData.deptName);
                    }
                    break;
            }
        }

        function goBack() {
            if (navigationHistory.length > 0) {
                const previous = navigationHistory.pop();
                currentPage = previous.page;
                currentPageData = previous.data;
                
                switch(previous.page) {
                    case 'home':
                        if (currentRole === 'student') {
                            showStudentHome();
                        } else {
                            showStaffAdminDashboard();
                        }
                        document.getElementById('backBtnNav').classList.remove('visible');
                        break;
                    case 'departments':
                        showDepartments();
                        break;
                    case 'courses':
                        showAllCourses();
                        break;
                    case 'markAttendance':
                        showMarkAttendance();
                        break;
                    case 'libraryGo':
                        showLibraryGo();
                        break;
                    case 'attendance':
                        showAttendance();
                        break;
                    case 'fees':
                        showFees();
                        break;
                    case 'myAccount':
                        showMyAccount();
                        break;
                    case 'tutorials':
                        showTutorials();
                        break;
                    case 'studentTimetable':
                        showStudentTimetable();
                        break;
                    case 'myMentor':
                        showMyMentor();
                        break;
                    case 'libraryVisits':
                        showLibraryVisits();
                        break;
                    case 'onlinePayment':
                        showOnlinePayment();
                        break;
                    case 'feePayment':
                        showFeePayment();
                        break;
                    default:
                        if (previous.page === 'departmentCourses' && previous.data) {
                            showDepartmentCourses(previous.data.deptName);
                        }
                }
            } else {
                currentPage = 'home';
                if (currentRole === 'student') {
                    showStudentHome();
                } else {
                    showStaffAdminDashboard();
                }
                document.getElementById('backBtnNav').classList.remove('visible');
            }
        }

        // ==================== LOGIN HANDLER ====================
        function setRole(role) {
            currentRole = role;
            document.querySelectorAll('.role-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');

            document.getElementById('studentFields').style.display = role === 'student' ? 'block' : 'none';
            document.getElementById('staffAdminFields').style.display = role !== 'student' ? 'block' : 'none';
        }

        function handleLogin(event) {
            event.preventDefault();
            
            if (currentRole === 'student') {
                const regNo = document.getElementById('registerNumber').value;
                const password = document.getElementById('password').value;

                const studentsList = window.csStudents || csStudents;
                const student = studentsList.find(s => s.reg === regNo && s.password === password);

                if (student) {
                    currentUser = {
                        ...student,
                        role: 'student',
                        department: 'Computer Science',
                        semester: 6
                    };
                    
                    saveSession();
                    
                    document.getElementById('loginPage').style.display = 'none';
                    document.getElementById('dashboard').classList.add('active');
                    
                    updateMenuForRole();
                    
                    const nameParts = student.name.split(' ');
                    const initials = nameParts.map(n => n[0]).join('').substring(0, 2).toUpperCase();
                    document.getElementById('userName').textContent = student.name;
                    document.getElementById('userAvatar').textContent = initials;
                    
                    navigationHistory = [];
                    currentPage = 'home';
                    
                    showNotification(`Welcome, ${student.name}!`, 'success');
                    showStudentHome();
                } else {
                    showNotification('Invalid Register Number or Password!', 'error');
                }
            } else if (currentRole === 'staff') {
                const email = document.getElementById('email').value;
                const password = document.getElementById('adminPassword').value;

                const staffList = window.staffMembers || staffMembers;
                const staff = staffList.find(s => s.email === email && s.password === password);

                if (staff) {
                    currentUser = { ...staff, role: 'staff' };
                    
                    saveSession();
                    
                    document.getElementById('loginPage').style.display = 'none';
                    document.getElementById('dashboard').classList.add('active');
                    
                    updateMenuForRole();
                    
                    document.getElementById('userName').textContent = staff.name;
                    const nameParts = staff.name.split(' ');
                    const initials = nameParts.map(n => n[0]).join('').substring(0, 2).toUpperCase();
                    document.getElementById('userAvatar').textContent = initials;
                    
                    navigationHistory = [];
                    currentPage = 'home';
                    
                    showNotification(`Welcome, ${staff.name}!`, 'success');
                    showStaffAdminDashboard();
                } else {
                    showNotification('Invalid email or password!', 'error');
                }
            } else if (currentRole === 'admin') {
                const email = document.getElementById('email').value;
                const password = document.getElementById('adminPassword').value;

                if (email === adminUser.email && password === adminUser.password) {
                    currentUser = { ...adminUser, role: 'admin' };
                    
                    saveSession();
                    
                    document.getElementById('loginPage').style.display = 'none';
                    document.getElementById('dashboard').classList.add('active');
                    
                    updateMenuForRole();
                    
                    document.getElementById('userName').textContent = 'Administrator';
                    document.getElementById('userAvatar').textContent = 'AD';
                    
                    navigationHistory = [];
                    currentPage = 'home';
                    
                    showNotification('Welcome, Admin!', 'success');
                    showStaffAdminDashboard();
                } else {
                    showNotification('Invalid admin credentials!', 'error');
                }
            }
        }

        function updateMenuForRole() {
            const menuGrid = document.getElementById('menuGrid');
            
            if (currentRole === 'student') {
                menuGrid.innerHTML = `
                    <div class="menu-grid-item" onclick="navigateTo('libraryGo')">
                        <span></span>
                        <span>Library Go</span>
                    </div>
                    <div class="menu-grid-item" onclick="navigateTo('attendance')">
                        <span></span>
                        <span>Attendance</span>
                    </div>
                    <div class="menu-grid-item" onclick="navigateTo('fees')">
                        <span></span>
                        <span>Fees</span>
                    </div>
                    <div class="menu-grid-item" onclick="navigateTo('myAccount')">
                        <span></span>
                        <span>My Account</span>
                    </div>
                    <div class="menu-grid-item" onclick="navigateTo('tutorials')">
                        <span></span>
                        <span>Tutorials</span>
                    </div>
                    <div class="menu-grid-item" onclick="navigateTo('studentTimetable')">
                        <span></span>
                        <span>Student Timetable</span>
                    </div>
                    <div class="menu-grid-item" onclick="navigateTo('myMentor')">
                        <span></span>
                        <span>My Mentor</span>
                    </div>
                    <div class="menu-grid-item" onclick="navigateTo('libraryVisits')">
                        <span></span>
                        <span>Library Visits</span>
                    </div>
                    <div class="menu-grid-item" onclick="navigateTo('onlinePayment')">
                        <span></span>
                        <span>Online Payment</span>
                    </div>
                    <div class="menu-grid-item" onclick="navigateTo('feePayment')">
                        <span></span>
                        <span>Fee Payment</span>
                    </div>
                `;
            } else {
                menuGrid.innerHTML = `
                    <div class="menu-grid-item" onclick="navigateTo('markAttendance')">
                        <span></span>
                        <span>Mark Attendance</span>
                    </div>
                    <div class="menu-grid-item" onclick="navigateTo('departments')">
                        <span></span>
                        <span>Departments</span>
                    </div>
                    <div class="menu-grid-item" onclick="navigateTo('courses')">
                        <span></span>
                        <span>All Courses</span>
                    </div>
                    <div class="menu-grid-item" onclick="navigateTo('students')">
                        <span></span>
                        <span>Students</span>
                    </div>
                    <div class="menu-grid-item" onclick="navigateTo('faculty')">
                        <span></span>
                        <span>Faculty</span>
                    </div>
                    <div class="menu-grid-item" onclick="navigateTo('libraryGo')">
                        <span></span>
                        <span>Library Go</span>
                    </div>
                    <div class="menu-grid-item" onclick="navigateTo('attendance')">
                        <span></span>
                        <span>Attendance</span>
                    </div>
                    <div class="menu-grid-item" onclick="navigateTo('fees')">
                        <span></span>
                        <span>Fees</span>
                    </div>
                    <div class="menu-grid-item" onclick="navigateTo('myAccount')">
                        <span></span>
                        <span>My Account</span>
                    </div>
                    <div class="menu-grid-item" onclick="navigateTo('tutorials')">
                        <span></span>
                        <span>Tutorials</span>
                    </div>
                    <div class="menu-grid-item" onclick="navigateTo('studentTimetable')">
                        <span></span>
                        <span>Student Timetable</span>
                    </div>
                    <div class="menu-grid-item" onclick="navigateTo('libraryVisits')">
                        <span></span>
                        <span>Library Visits</span>
                    </div>
                    <div class="menu-grid-item" onclick="navigateTo('onlinePayment')">
                        <span></span>
                        <span>Online Payment</span>
                    </div>
                    <div class="menu-grid-item" onclick="navigateTo('feePayment')">
                        <span></span>
                        <span>Fee Payment</span>
                    </div>
                `;
            }
        }

        function navigateTo(section) {
            document.getElementById('fullMenu').classList.remove('open');
            document.getElementById('mainContent').style.display = 'block';
            
            let sectionName = '';
            switch(section) {
                case 'markAttendance': sectionName = 'Mark Attendance'; navigateToPage('markAttendance'); break;
                case 'departments': sectionName = 'Departments'; navigateToPage('departments'); break;
                case 'courses': sectionName = 'All Courses'; navigateToPage('courses'); break;
                case 'students': sectionName = 'Students'; navigateToPage('students'); break;
                case 'faculty': sectionName = 'Faculty'; navigateToPage('faculty'); break;
                case 'libraryGo': sectionName = 'Library Go'; navigateToPage('libraryGo'); break;
                case 'attendance': sectionName = 'Attendance'; navigateToPage('attendance'); break;
                case 'fees': sectionName = 'Fees'; navigateToPage('fees'); break;
                case 'myAccount': sectionName = 'My Account'; navigateToPage('myAccount'); break;
                case 'tutorials': sectionName = 'Tutorials'; navigateToPage('tutorials'); break;
                case 'studentTimetable': sectionName = 'Student Timetable'; navigateToPage('studentTimetable'); break;
                case 'myMentor': sectionName = 'My Mentor'; navigateToPage('myMentor'); break;
                case 'libraryVisits': sectionName = 'Library Visits'; navigateToPage('libraryVisits'); break;
                case 'onlinePayment': sectionName = 'Online Payment'; navigateToPage('onlinePayment'); break;
                case 'feePayment': sectionName = 'Fee Payment'; navigateToPage('feePayment'); break;
            }
            
            if (!recentItems.includes(sectionName) && sectionName) {
                recentItems.unshift(sectionName);
                if (recentItems.length > 5) recentItems.pop();
                updateRecentItems();
            }
        }

        function switchTab(tab) {
            currentTab = tab;
            
            document.querySelectorAll('.nav-item').forEach(item => item.classList.remove('active'));
            event.target.closest('.nav-item').classList.add('active');

            if (tab === 'home') {
                document.getElementById('fullMenu').classList.remove('open');
                document.getElementById('mainContent').style.display = 'block';
                
                navigationHistory = [];
                currentPage = 'home';
                expandedPeriod = null;
                document.getElementById('backBtnNav').classList.remove('visible');
                
                if (currentUser?.role === 'student') {
                    showStudentHome();
                } else {
                    showStaffAdminDashboard();
                }
            } else if (tab === 'menu') {
                toggleMenu();
            } else if (tab === 'profile') {
                document.getElementById('fullMenu').classList.remove('open');
                document.getElementById('mainContent').style.display = 'block';
                navigateToPage('myAccount');
            }
        }

        function toggleMenu() {
            menuOpen = !menuOpen;
            document.getElementById('fullMenu').classList.toggle('open', menuOpen);
            document.getElementById('mainContent').style.display = menuOpen ? 'none' : 'block';
        }

        function toggleTheme() {
            document.body.classList.toggle('dark-mode');
        }

        function searchMenu(query) {
            const items = document.querySelectorAll('.menu-grid-item');
            items.forEach(item => {
                const text = item.querySelector('span:last-child').textContent.toLowerCase();
                if (text.includes(query.toLowerCase())) {
                    item.style.display = 'flex';
                } else {
                    item.style.display = 'none';
                }
            });
        }

        function clearRecent() {
            recentItems = [];
            updateRecentItems();
        }

        function updateRecentItems() {
            const recentDiv = document.getElementById('recentItems');
            if (recentItems.length === 0) {
                recentDiv.innerHTML = '<div class="recent-item">No recent items</div>';
            } else {
                recentDiv.innerHTML = recentItems.map(item => {
                    const section = item.toLowerCase().replace(/ /g, '').replace(/[^a-z]/g, '');
                    return `
                        <div class="recent-item" onclick="navigateTo('${section}')">
                            <span>${getIconForItem(item)}</span>
                            <span>${item}</span>
                        </div>
                    `;
                }).join('');
            }
        }

        function getIconForItem(item) {
            const icons = {
                'Mark Attendance': '',
                'Departments': '',
                'All Courses': '',
                'Students': '',
                'Faculty': '',
                'Library Go': '',
                'Attendance': '',
                'Fees': '',
                'My Account': '',
                'Tutorials': '',
                'Student Timetable': '',
                'My Mentor': '',
                'Library Visits': '',
                'Online Payment': '',
                'Fee Payment': ''
            };
            return icons[item] || '';
        }

        // ==================== STUDENT HOME ====================
        function showStudentHome() {
            const content = document.getElementById('mainContent');
            const today = new Date();
            const todayStr = today.toISOString().split('T')[0];
            const dayName = today.toLocaleDateString('en-US', { weekday: 'long' });
            const month = today.toLocaleDateString('en-US', { month: 'short' });
            const day = today.getDate();
            
            const studentId = currentUser.reg;
            const todayAttendance = [];
            const periodDetails = {};
            
            for (let hour = 1; hour <= 5; hour++) {
                const key = `${studentId}_${todayStr}_${hour}`;
                if (attendanceData[key]) {
                    todayAttendance.push({
                        hour: hour,
                        status: attendanceData[key],
                        faculty: attendanceData[key + '_faculty'] || 'Not assigned',
                        course: attendanceData[key + '_course'] || 'No course',
                        details: attendanceData[key + '_details'] || ''
                    });
                }
                periodDetails[hour] = {
                    status: attendanceData[key] || null,
                    faculty: attendanceData[key + '_faculty'] || null,
                    course: attendanceData[key + '_course'] || null,
                    details: attendanceData[key + '_details'] || null
                };
            }
            
            let hoursGridHTML = '<div class="hours-grid">';
            for (let hour = 1; hour <= 5; hour++) {
                const attendance = todayAttendance.find(a => a.hour === hour);
                const status = attendance ? attendance.status : null;
                hoursGridHTML += `
                    <div class="hour-box ${status || ''}" onclick="showPeriodDetail(${hour})">
                        <div class="hour">${hour} hr</div>
                        ${status ? `<div class="status">${getStatusText(status)}</div>` : ''}
                    </div>
                `;
            }
            hoursGridHTML += '</div>';
            
            // Generate period detail if expanded
            let periodDetailHTML = '';
            if (expandedPeriod !== null && periodDetails[expandedPeriod]) {
                const detail = periodDetails[expandedPeriod];
                if (detail.status) {
                    periodDetailHTML = `
                        <div class="period-detail-card">
                            <div class="period-detail-header">
                                <h3>Class - Hour ${expandedPeriod}</h3>
                                <span class="period-time">${getPeriodTime(expandedPeriod)}</span>
                            </div>
                            <div class="period-detail-content">
                                <div class="period-detail-row">
                                    <span class="period-detail-label">Faculty:</span>
                                    <span class="period-detail-value faculty">${detail.faculty || 'Not assigned'}</span>
                                </div>
                                <div class="period-detail-row">
                                    <span class="period-detail-label">Status:</span>
                                    <span class="period-detail-value status ${detail.status}">${getStatusText(detail.status) || detail.status}</span>
                                </div>
                                <div class="period-detail-course">
                                    <h4>${detail.course || 'No course'}</h4>
                                    ${detail.details ? `<p class="course-code">${detail.details}</p>` : ''}
                                </div>
                            </div>
                        </div>
                    `;
                } else {
                    periodDetailHTML = `
                        <div class="period-detail-card">
                            <div class="period-detail-header">
                                <h3>Class - Hour ${expandedPeriod}</h3>
                                <span class="period-time">${getPeriodTime(expandedPeriod)}</span>
                            </div>
                            <div class="period-detail-content">
                                <p style="text-align: center; color: #666;">No attendance marked for this period</p>
                            </div>
                        </div>
                    `;
                }
            }
            
            content.innerHTML = `
                <div class="student-home">
                    <div class="student-header">
                        <h1>${currentUser.name}</h1>
                        <p>Admission No : ${currentUser.reg}</p>
                    </div>

                    <!-- Hours Grid -->
                    ${hoursGridHTML}

                    ${periodDetailHTML}

                    <!-- View All Link -->
                    <div class="view-all-link">
                        <a href="#" onclick="navigateTo('attendance'); return false;">View all attendance requests </a>
                    </div>

                    <!-- Feedback Section -->
                    <div class="feedback-section">
                        <p>Every feedback is valuable.</p>
                        <button class="feedback-btn" onclick="showNotification('Thank you for your feedback!', 'success')">Give Feedback</button>
                    </div>

                    <!-- Favorites Navigation -->
                    <div class="favorites-nav">
                        <span class="title">Favorites</span>
                        <div class="actions">
                            <span onclick="navigateTo('attendance')">Attendance</span>
                            <span onclick="showNotification('Add More feature coming soon', 'info')">Add More</span>
                        </div>
                    </div>

                    <!-- Schedule Section -->
                    <div class="schedule-section">
                        <div class="schedule-header">
                            <h3>Today's schedule</h3>
                            <span class="schedule-date">${dayName}, ${month} ${day}</span>
                        </div>
                        <div class="schedule-item">
                            <div class="schedule-time">12:40 to 01:30</div>
                            <div class="schedule-details">
                                <h4>20BJM609-Operating Systems</h4>
                                <p>Mohammed Arshad F</p>
                            </div>
                        </div>
                    </div>

                    <!-- Result Card -->
                    <div class="result-card">
                        <div class="card-header">
                            <h3>Latest Result</h3>
                            <a href="#" class="see-all" onclick="showNotification('Viewing all results', 'info'); return false;">See All </a>
                        </div>
                        <div class="no-result">
                            <p>No Result Published</p>
                            <small>Your SGPA and GPA will be shown here as soon as they're published</small>
                        </div>
                    </div>

                    <!-- Semester Card -->
                    <div class="semester-card">
                        <div class="card-header">
                            <h3>Semester Wise Attendance</h3>
                            <a href="#" class="see-all" onclick="navigateTo('attendance'); return false;">See All </a>
                        </div>
                        <div>
                            <h4>Semester 6</h4>
                            <p style="color: #666; font-size: 13px; margin-bottom: 10px;">Current Semester</p>
                            <div class="semester-stats">
                                <div class="stats-details">
                                    <div class="stat-row">
                                        <span class="stat-label">Total Hours</span>
                                        <span class="stat-value">172.0</span>
                                    </div>
                                    <div class="stat-row">
                                        <span class="stat-label">Hours Present</span>
                                        <span class="stat-value">171.0</span>
                                    </div>
                                </div>
                                <div class="percentage-circle">99.42</div>
                            </div>
                        </div>
                    </div>

                    <!-- Notice Card -->
                    <div class="notice-card">
                        <div class="card-header">
                            <h3>Notice Board</h3>
                            <a href="#" class="see-all" onclick="showNotification('Viewing all notices', 'info'); return false;">See All </a>
                        </div>
                        <div class="notice-content">
                            <div class="notice-icon"></div>
                            <h4>Notice Board is Quiet Today</h4>
                            <p>Stay tuned  exciting updates are on the way</p>
                        </div>
                    </div>

                    <!-- Events Card -->
                    <div class="events-card">
                        <div class="events-header">
                            <h3>Events & News</h3>
                            <a href="#" class="see-all" onclick="showNotification('Viewing all events', 'info'); return false;">See All </a>
                        </div>
                        <div class="event-item">
                            <div class="event-date">
                                <div class="day">15</div>
                                <div class="month">MAR</div>
                            </div>
                            <div class="event-details">
                                <h4>Mid Term Examinations Begin</h4>
                                <p>All departments  10:00 AM</p>
                            </div>
                        </div>
                        <div class="event-item">
                            <div class="event-date">
                                <div class="day">20</div>
                                <div class="month">MAR</div>
                            </div>
                            <div class="event-details">
                                <h4>Technical Symposium</h4>
                                <p>Computer Science Dept  09:30 AM</p>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        function showPeriodDetail(hour) {
            if (expandedPeriod === hour) {
                expandedPeriod = null;
            } else {
                expandedPeriod = hour;
            }
            showStudentHome();
        }

        function getStatusText(status) {
            switch(status) {
                case 'present': return ' Present';
                case 'absent': return ' Absent';
                case 'late': return ' Late';
                case 'letoff': return ' Let-off';
                default: return '';
            }
        }

        function getPeriodTime(period) {
            const times = {
                1: '09:00 - 10:00',
                2: '10:00 - 11:00',
                3: '11:00 - 12:00',
                4: '12:00 - 01:00',
                5: '02:00 - 03:00'
            };
            return times[period] || '';
        }

        // ==================== STAFF/ADMIN DASHBOARD ====================
        function showStaffAdminDashboard() {
            const content = document.getElementById('mainContent');
            const studentsList = window.csStudents || csStudents;
            const staffList = window.staffMembers || staffMembers;
            const coursesList = window.courses || courses;
            
            content.innerHTML = `
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-title">Total Students</div>
                        <div class="stat-value">${studentsList.length}</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-title">Total Staff</div>
                        <div class="stat-value">${staffList.length}</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-title">Total Courses</div>
                        <div class="stat-value">${coursesList.length}</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-title">Today's Date</div>
                        <div class="stat-value">${new Date().toLocaleDateString()}</div>
                    </div>
                </div>

                <div class="table-container">
                    <div class="table-header">
                        <h3>Quick Actions</h3>
                    </div>
                    <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 10px;">
                        <button class="btn-primary" onclick="navigateTo('markAttendance')" style="padding: 15px;"> Mark Attendance</button>
                        <button class="btn-primary" onclick="navigateTo('departments')" style="padding: 15px;"> View Departments</button>
                        <button class="btn-primary" onclick="navigateTo('courses')" style="padding: 15px;"> View Courses</button>
                        <button class="btn-primary" onclick="navigateTo('students')" style="padding: 15px;"> View Students</button>
                        <button class="btn-primary" onclick="navigateTo('faculty')" style="padding: 15px;"> View Faculty</button>
                    </div>
                </div>
            `;
        }

        // ==================== PROFILE PAGE ====================
        function showProfile() {
            const content = document.getElementById('mainContent');
            
            content.innerHTML = `
                <div class="account-page">
                    <div class="account-header">
                        <div class="profile-avatar" style="width: 80px; height: 80px; background: #8B0000; border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; font-size: 32px; margin: 0 auto 15px;">
                            ${currentUser.name.split(' ').map(n => n[0]).join('').substring(0, 2).toUpperCase()}
                        </div>
                        <h2>${currentUser.name}</h2>
                        <p>${currentUser.role === 'student' ? 'Register No: ' + currentUser.reg : currentUser.role === 'staff' ? 'Staff Member' : 'Administrator'}</p>
                    </div>

                    <div class="profile-details">
                        <div class="detail-row">
                            <span class="detail-label">Email</span>
                            <span class="detail-value">${currentUser.email || (currentUser.role === 'student' ? 'student@thenewcollege.edu.in' : currentUser.email || 'staff@thenewcollege.edu.in')}</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Department</span>
                            <span class="detail-value">${currentUser.department || 'Computer Science'}</span>
                        </div>
                        ${currentUser.role === 'staff' ? `
                        <div class="detail-row">
                            <span class="detail-label">Designation</span>
                            <span class="detail-value">${currentUser.designation || 'Faculty'}</span>
                        </div>
                        ` : ''}
                        ${currentUser.role === 'student' ? `
                        <div class="detail-row">
                            <span class="detail-label">Semester</span>
                            <span class="detail-value">${currentUser.semester || '6'}</span>
                        </div>
                        ` : ''}
                        <div class="detail-row">
                            <span class="detail-label">Phone</span>
                            <span class="detail-value">+91 98765 43210</span>
                        </div>
                    </div>

                    <button class="logout-btn-account" onclick="logout()">Logout</button>
                </div>
            `;
        }

        // ==================== MARK ATTENDANCE PAGE ====================
        function showMarkAttendance() {
            const content = document.getElementById('mainContent');
            const today = new Date().toISOString().split('T')[0];
            const studentsList = window.csStudents || csStudents;
            const coursesList = window.courses || courses;
            
            // Initialize student statuses for selected period and course
            if (!attendanceData[selectedPeriod]) {
                attendanceData[selectedPeriod] = {};
            }
            if (!attendanceData[selectedPeriod][selectedCourse]) {
                attendanceData[selectedPeriod][selectedCourse] = {};
                
                studentsList.forEach(student => {
                    const key = `${student.reg}_${today}_${selectedPeriod}`;
                    attendanceData[selectedPeriod][selectedCourse][student.reg] = attendanceData[key] || 'unmarked';
                });
            }
            
            content.innerHTML = `
                <div class="mark-attendance-page">
                    <h2 style="color: #8B0000; margin-bottom: 20px;">Mark Attendance</h2>
                    <p style="margin-bottom: 20px;">Date: ${new Date().toLocaleDateString('en-US', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' })}</p>
                    
                    <!-- Period Selector -->
                    <div class="period-selector">
                        <h3>Select Period</h3>
                        <div class="period-grid">
                            ${[1, 2, 3, 4, 5].map(period => `
                                <div class="period-card ${selectedPeriod === period ? 'selected' : ''}" onclick="selectPeriod(${period})">
                                    <div class="period-number">Period ${period}</div>
                                    <div class="period-time">${getPeriodTime(period)}</div>
                                </div>
                            `).join('')}
                        </div>
                    </div>

                    <!-- Course Selector -->
                    <div class="course-selector">
                        <h3>Select Course</h3>
                        <select class="course-select" onchange="selectCourse(this.value)">
                            <option value="">Choose a course...</option>
                            ${coursesList.map(course => `
                                <option value="${course.id}" ${selectedCourse == course.id ? 'selected' : ''}>${course.code} - ${course.name}</option>
                            `).join('')}
                        </select>
                    </div>

                    ${selectedCourse ? `
                        <!-- Mark All Section -->
                        <div class="mark-all-section">
                            <h3>Quick Mark All</h3>
                            <div class="mark-all-buttons">
                                <button class="mark-all-btn present" onclick="markAllStudents('present')"> All Present</button>
                                <button class="mark-all-btn absent" onclick="markAllStudents('absent')"> All Absent</button>
                                <button class="mark-all-btn late" onclick="markAllStudents('late')"> All Late</button>
                                <button class="mark-all-btn letoff" onclick="markAllStudents('letoff')"> All Let-off</button>
                            </div>
                        </div>

                        <!-- Student List -->
                        <div class="student-list">
                            <div class="student-list-header">
                                <h3>Students</h3>
                            </div>
                            ${studentsList.map(student => {
                                const status = attendanceData[selectedPeriod][selectedCourse][student.reg] || 'unmarked';
                                return `
                                    <div class="student-list-item" id="student-${student.reg}">
                                        <div class="student-info">
                                            <h4>${student.name}</h4>
                                            <p>${student.reg}</p>
                                        </div>
                                        <div class="student-status">
                                            <div class="status-option present ${status === 'present' ? 'active' : ''}" onclick="setStudentStatus('${student.reg}', 'present')"></div>
                                            <div class="status-option absent ${status === 'absent' ? 'active' : ''}" onclick="setStudentStatus('${student.reg}', 'absent')"></div>
                                            <div class="status-option late ${status === 'late' ? 'active' : ''}" onclick="setStudentStatus('${student.reg}', 'late')"></div>
                                            <div class="status-option letoff ${status === 'letoff' ? 'active' : ''}" onclick="setStudentStatus('${student.reg}', 'letoff')"></div>
                                        </div>
                                    </div>
                                `;
                            }).join('')}
                        </div>

                        <!-- Submit Buttons -->
                        <div class="submit-attendance">
                            <button class="cancel-btn" onclick="resetAttendance()">Reset</button>
                            <button class="submit-btn" onclick="submitAttendance()">Submit Attendance</button>
                        </div>
                    ` : `
                        <div style="text-align: center; padding: 50px; color: #666;">
                            Please select a course to start marking attendance
                        </div>
                    `}
                </div>
            `;
        }

        function selectPeriod(period) {
            selectedPeriod = period;
            showMarkAttendance();
        }

        function selectCourse(courseId) {
            selectedCourse = parseInt(courseId);
            showMarkAttendance();
        }

        function setStudentStatus(regNo, status) {
            if (!selectedCourse) return;
            
            attendanceData[selectedPeriod][selectedCourse][regNo] = status;
            
            const studentDiv = document.getElementById(`student-${regNo}`);
            if (studentDiv) {
                const options = studentDiv.querySelectorAll('.status-option');
                options.forEach(opt => {
                    opt.classList.remove('active');
                });
                studentDiv.querySelector(`.status-option.${status}`).classList.add('active');
            }
        }

        function markAllStudents(status) {
            if (!selectedCourse) return;
            
            const studentsList = window.csStudents || csStudents;
            studentsList.forEach(student => {
                attendanceData[selectedPeriod][selectedCourse][student.reg] = status;
            });
            
            studentsList.forEach(student => {
                const studentDiv = document.getElementById(`student-${student.reg}`);
                if (studentDiv) {
                    const options = studentDiv.querySelectorAll('.status-option');
                    options.forEach(opt => {
                        opt.classList.remove('active');
                    });
                    studentDiv.querySelector(`.status-option.${status}`).classList.add('active');
                }
            });
        }

        function resetAttendance() {
            if (!selectedCourse) return;
            
            attendanceData[selectedPeriod][selectedCourse] = {};
            const studentsList = window.csStudents || csStudents;
            studentsList.forEach(student => {
                attendanceData[selectedPeriod][selectedCourse][student.reg] = 'unmarked';
            });
            showMarkAttendance();
        }

        function submitAttendance() {
            if (!selectedCourse) return;
            
            const today = new Date().toISOString().split('T')[0];
            const coursesList = window.courses || courses;
            const selectedCourseObj = coursesList.find(c => c.id == selectedCourse);
            const studentsList = window.csStudents || csStudents;
            
            studentsList.forEach(student => {
                const status = attendanceData[selectedPeriod][selectedCourse][student.reg];
                if (status && status !== 'unmarked') {
                    const key = `${student.reg}_${today}_${selectedPeriod}`;
                    attendanceData[key] = status;
                    attendanceData[key + '_faculty'] = currentUser.name;
                    attendanceData[key + '_course'] = selectedCourseObj ? `${selectedCourseObj.code}-${selectedCourseObj.name}` : 'Course';
                    attendanceData[key + '_details'] = selectedCourseObj ? selectedCourseObj.faculty : '';
                }
            });
            
            // Save to Google Sheets
            saveAttendanceToSheet();
            
            showNotification(`Attendance for Period ${selectedPeriod} submitted successfully!`, 'success');
            
            selectedCourse = null;
            showMarkAttendance();
        }

        // ==================== DEPARTMENTS PAGE ====================
        function showDepartments() {
            const content = document.getElementById('mainContent');
            
            content.innerHTML = `
                <div class="departments-page">
                    <div class="table-header">
                        <h3>Academic Departments</h3>
                    </div>
                    
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-title">Total Departments</div>
                            <div class="stat-value">24</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-title">Total Courses</div>
                            <div class="stat-value">62</div>
                        </div>
                    </div>

                    <div class="departments-grid">
                        <div class="department-card" onclick="viewDepartmentCourses('Computer Science')">
                            <h3>Computer Science</h3>
                            <div class="department-stats">
                                <span>HOD: Dr. CS HOD</span>
                                <span>Faculty: 15</span>
                            </div>
                            <div class="course-preview">
                                <span class="course-tag">B.Sc. CS</span>
                                <span class="course-tag">M.Sc. CS</span>
                                <span class="course-tag">Ph.D</span>
                            </div>
                            <button class="view-courses-btn">View Courses </button>
                        </div>
                        <div class="department-card" onclick="viewDepartmentCourses('English')">
                            <h3>English</h3>
                            <div class="department-stats">
                                <span>HOD: Dr. English HOD</span>
                                <span>Faculty: 12</span>
                            </div>
                            <div class="course-preview">
                                <span class="course-tag">B.A. English</span>
                                <span class="course-tag">M.A. English</span>
                                <span class="course-tag">Ph.D</span>
                            </div>
                            <button class="view-courses-btn">View Courses </button>
                        </div>
                        <div class="department-card" onclick="viewDepartmentCourses('Mathematics')">
                            <h3>Mathematics</h3>
                            <div class="department-stats">
                                <span>HOD: Dr. Maths HOD</span>
                                <span>Faculty: 18</span>
                            </div>
                            <div class="course-preview">
                                <span class="course-tag">B.Sc. Maths</span>
                                <span class="course-tag">M.Sc. Maths</span>
                                <span class="course-tag">Ph.D</span>
                            </div>
                            <button class="view-courses-btn">View Courses </button>
                        </div>
                        <div class="department-card" onclick="viewDepartmentCourses('Physics')">
                            <h3>Physics</h3>
                            <div class="department-stats">
                                <span>HOD: Dr. Physics HOD</span>
                                <span>Faculty: 16</span>
                            </div>
                            <div class="course-preview">
                                <span class="course-tag">B.Sc. Physics</span>
                                <span class="course-tag">M.Sc. Physics</span>
                                <span class="course-tag">Ph.D</span>
                            </div>
                            <button class="view-courses-btn">View Courses </button>
                        </div>
                        <div class="department-card" onclick="viewDepartmentCourses('Chemistry')">
                            <h3>Chemistry</h3>
                            <div class="department-stats">
                                <span>HOD: Dr. Chemistry HOD</span>
                                <span>Faculty: 17</span>
                            </div>
                            <div class="course-preview">
                                <span class="course-tag">B.Sc. Chemistry</span>
                                <span class="course-tag">M.Sc. Chemistry</span>
                                <span class="course-tag">Ph.D</span>
                            </div>
                            <button class="view-courses-btn">View Courses </button>
                        </div>
                        <div class="department-card" onclick="viewDepartmentCourses('Botany')">
                            <h3>Botany</h3>
                            <div class="department-stats">
                                <span>HOD: Dr. Botany HOD</span>
                                <span>Faculty: 13</span>
                            </div>
                            <div class="course-preview">
                                <span class="course-tag">B.Sc. Botany</span>
                                <span class="course-tag">M.Sc. Botany</span>
                            </div>
                            <button class="view-courses-btn">View Courses </button>
                        </div>
                        <div class="department-card" onclick="viewDepartmentCourses('Zoology')">
                            <h3>Zoology</h3>
                            <div class="department-stats">
                                <span>HOD: Dr. Zoology HOD</span>
                                <span>Faculty: 13</span>
                            </div>
                            <div class="course-preview">
                                <span class="course-tag">B.Sc. Zoology</span>
                                <span class="course-tag">M.Sc. Zoology</span>
                                <span class="course-tag">Ph.D</span>
                            </div>
                            <button class="view-courses-btn">View Courses </button>
                        </div>
                        <div class="department-card" onclick="viewDepartmentCourses('Commerce')">
                            <h3>Commerce</h3>
                            <div class="department-stats">
                                <span>HOD: Dr. Commerce HOD</span>
                                <span>Faculty: 20</span>
                            </div>
                            <div class="course-preview">
                                <span class="course-tag">B.Com</span>
                                <span class="course-tag">M.Com</span>
                            </div>
                            <button class="view-courses-btn">View Courses </button>
                        </div>
                        <div class="department-card" onclick="viewDepartmentCourses('Economics')">
                            <h3>Economics</h3>
                            <div class="department-stats">
                                <span>HOD: Dr. Economics HOD</span>
                                <span>Faculty: 14</span>
                            </div>
                            <div class="course-preview">
                                <span class="course-tag">B.A. Eco</span>
                                <span class="course-tag">M.A. Eco</span>
                            </div>
                            <button class="view-courses-btn">View Courses </button>
                        </div>
                        <div class="department-card" onclick="viewDepartmentCourses('History')">
                            <h3>History</h3>
                            <div class="department-stats">
                                <span>HOD: Dr. History HOD</span>
                                <span>Faculty: 15</span>
                            </div>
                            <div class="course-preview">
                                <span class="course-tag">B.A. History</span>
                                <span class="course-tag">M.A. History</span>
                            </div>
                            <button class="view-courses-btn">View Courses </button>
                        </div>
                    </div>
                </div>
            `;
        }

        function viewDepartmentCourses(deptName) {
            navigateToPage('departmentCourses', { deptName: deptName });
            
            const content = document.getElementById('mainContent');
            
            const deptCourses = {
                'Computer Science': [
                    { name: 'B.Sc. Computer Science', code: 'UCSC01', level: 'UG', credits: 3, faculty: 'M M Syed Sulaiman' },
                    { name: 'B.Sc. Computer Science with AI', code: 'UCSA01', level: 'UG', credits: 3, faculty: 'Dr. AI Faculty' },
                    { name: 'B.Sc. Computer Science with Data Science', code: 'UCSD01', level: 'UG', credits: 3, faculty: 'Dr. Data Science Faculty' },
                    { name: 'M.Sc. Computer Science', code: 'PCSC01', level: 'PG', credits: 4, faculty: 'Dr. CS Faculty' }
                ],
                'English': [
                    { name: 'B.A. English', code: 'UENG01', level: 'UG', credits: 3, faculty: 'Dr. English Faculty' },
                    { name: 'M.A. English', code: 'PENG01', level: 'PG', credits: 4, faculty: 'Dr. English Faculty' },
                    { name: 'M.Phil. English', code: 'MENG01', level: 'M.Phil', credits: 2, faculty: 'Dr. English Faculty' },
                    { name: 'Ph.D. English', code: 'DENG01', level: 'Ph.D', credits: 0, faculty: 'Dr. English Faculty' }
                ],
                'Mathematics': [
                    { name: 'B.Sc. Mathematics', code: 'UMAT01', level: 'UG', credits: 3, faculty: 'Dr. Maths Faculty' },
                    { name: 'M.Sc. Mathematics', code: 'PMAT01', level: 'PG', credits: 4, faculty: 'Dr. Maths Faculty' },
                    { name: 'Ph.D. Mathematics', code: 'DMAT01', level: 'Ph.D', credits: 0, faculty: 'Dr. Maths Faculty' }
                ],
                'Physics': [
                    { name: 'B.Sc. Physics', code: 'UPHY01', level: 'UG', credits: 3, faculty: 'Dr. Physics Faculty' },
                    { name: 'M.Sc. Physics', code: 'PPHY01', level: 'PG', credits: 4, faculty: 'Dr. Physics Faculty' },
                    { name: 'Ph.D. Physics', code: 'DPHY01', level: 'Ph.D', credits: 0, faculty: 'Dr. Physics Faculty' }
                ],
                'Chemistry': [
                    { name: 'B.Sc. Chemistry', code: 'UCHE01', level: 'UG', credits: 3, faculty: 'Dr. Chemistry Faculty' },
                    { name: 'M.Sc. Chemistry', code: 'PCHE01', level: 'PG', credits: 4, faculty: 'Dr. Chemistry Faculty' },
                    { name: 'Ph.D. Chemistry', code: 'DCHE01', level: 'Ph.D', credits: 0, faculty: 'Dr. Chemistry Faculty' }
                ]
            };
            
            const courses = deptCourses[deptName] || [];
            
            content.innerHTML = `
                <div class="departments-page">
                    <button class="back-btn" onclick="goBack()"> Back to Departments</button>
                    
                    <div class="department-header">
                        <h2>${deptName} Department</h2>
                        <p>Explore our courses and programs</p>
                    </div>

                    <div class="courses-grid">
                        ${courses.map(course => `
                            <div class="course-card">
                                <span class="badge badge-${course.level.toLowerCase().replace('.', '')}">${course.level}</span>
                                <h4>${course.name}</h4>
                                <div class="course-code">${course.code}</div>
                                <div class="course-meta">
                                    <span>Credits: ${course.credits}</span>
                                </div>
                                <div class="course-meta">
                                    <span>Faculty: ${course.faculty}</span>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `;
        }

        // ==================== ALL COURSES PAGE ====================
        function showAllCourses() {
            const content = document.getElementById('mainContent');
            const coursesList = window.courses || courses;
            
            content.innerHTML = `
                <div class="departments-page">
                    <div class="table-header">
                        <h3>All Courses</h3>
                    </div>
                    
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-title">UG Courses</div>
                            <div class="stat-value">35</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-title">PG Courses</div>
                            <div class="stat-value">15</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-title">M.Phil Courses</div>
                            <div class="stat-value">7</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-title">Ph.D Courses</div>
                            <div class="stat-value">5</div>
                        </div>
                    </div>

                    <div class="courses-grid">
                        ${coursesList.map(course => `
                            <div class="course-card">
                                <span class="badge badge-ug">UG</span>
                                <h4>${course.name}</h4>
                                <div class="course-code">${course.code}</div>
                                <div class="course-meta">
                                    <span>Faculty: ${course.faculty}</span>
                                </div>
                                <div class="course-meta">
                                    <span>Total Hours: ${course.totalHours}</span>
                                </div>
                            </div>
                        `).join('')}
                        <div class="course-card">
                            <span class="badge badge-ug">UG</span>
                            <h4>B.Sc. Computer Science with AI</h4>
                            <div class="course-code">UCSA01</div>
                            <div class="course-meta">
                                <span>Faculty: Dr. AI Faculty</span>
                            </div>
                        </div>
                        <div class="course-card">
                            <span class="badge badge-ug">UG</span>
                            <h4>B.Sc. Computer Science with Data Science</h4>
                            <div class="course-code">UCSD01</div>
                            <div class="course-meta">
                                <span>Faculty: Dr. Data Science Faculty</span>
                            </div>
                        </div>
                        <div class="course-card">
                            <span class="badge badge-pg">PG</span>
                            <h4>M.Sc. Computer Science</h4>
                            <div class="course-code">PCSC01</div>
                            <div class="course-meta">
                                <span>Faculty: Dr. CS Faculty</span>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        // ==================== STUDENTS PAGE ====================
        function showStudents() {
            const content = document.getElementById('mainContent');
            const studentsList = window.csStudents || csStudents;
            
            content.innerHTML = `
                <div class="table-container">
                    <div class="table-header">
                        <h3>Student List - Computer Science (3rd Year)</h3>
                    </div>
                    <table>
                        <thead>
                            <tr>
                                <th>S.No</th>
                                <th>Register No</th>
                                <th>Student Name</th>
                                <th>Department</th>
                                <th>Year</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${studentsList.map((student, index) => `
                                <tr>
                                    <td>${index + 1}</td>
                                    <td>${student.reg}</td>
                                    <td>${student.name}</td>
                                    <td>Computer Science</td>
                                    <td>3rd Year</td>
                                </tr>
                            `).join('')}
                        </tbody>
                    </table>
                </div>
            `;
        }

        // ==================== FACULTY PAGE ====================
        function showFaculty() {
            const content = document.getElementById('mainContent');
            const staffList = window.staffMembers || staffMembers;
            
            content.innerHTML = `
                <div class="table-container">
                    <div class="table-header">
                        <h3>Faculty List</h3>
                    </div>
                    <table>
                        <thead>
                            <tr>
                                <th>S.No</th>
                                <th>Name</th>
                                <th>Department</th>
                                <th>Designation</th>
                                <th>Email</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${staffList.map((staff, index) => `
                                <tr>
                                    <td>${index + 1}</td>
                                    <td>${staff.name}</td>
                                    <td>${staff.department}</td>
                                    <td>${staff.designation}</td>
                                    <td>${staff.email}</td>
                                </tr>
                            `).join('')}
                        </tbody>
                    </table>
                </div>
            `;
        }

        // ==================== ATTENDANCE PAGE ====================
        function showAttendance() {
            const content = document.getElementById('mainContent');
            
            if (currentUser.role === 'student') {
                const studentId = currentUser.reg;
                
                const studentAttendance = [];
                for (const [key, status] of Object.entries(attendanceData)) {
                    if (key.includes('_') && !key.includes('_faculty') && !key.includes('_course') && !key.includes('_details')) {
                        const [sid, date, hour] = key.split('_');
                        if (sid === studentId) {
                            studentAttendance.push({
                                date: date,
                                hour: parseInt(hour),
                                status: status,
                                faculty: attendanceData[key + '_faculty'],
                                course: attendanceData[key + '_course'],
                                details: attendanceData[key + '_details']
                            });
                        }
                    }
                }
                
                const groupedByDate = {};
                studentAttendance.forEach(record => {
                    if (!groupedByDate[record.date]) {
                        groupedByDate[record.date] = [];
                    }
                    groupedByDate[record.date].push(record);
                });
                
                const sortedDates = Object.keys(groupedByDate).sort().reverse();
                
                let attendanceHTML = '';
                for (const date of sortedDates) {
                    const records = groupedByDate[date];
                    attendanceHTML += `<h4 style="margin: 20px 0 10px; color: #8B0000;">${date}</h4>`;
                    
                    for (const record of records) {
                        attendanceHTML += `
                            <div class="class-card" style="margin-bottom: 10px;">
                                <div class="class-header">
                                    <span class="class-title">Hour ${record.hour}</span>
                                    <span class="class-status ${record.status}">${getStatusText(record.status)}</span>
                                </div>
                                <div class="faculty-name">${record.faculty || 'Unknown'}</div>
                                <div class="class-details">${record.course || 'No course'}</div>
                                ${record.details ? `<div class="class-details">${record.details}</div>` : ''}
                            </div>
                        `;
                    }
                }
                
                content.innerHTML = `
                    <div class="attendance-page">
                        <div class="attendance-tabs">
                            <button class="attendance-tab active" onclick="showAttendanceCourse()">Course</button>
                            <button class="attendance-tab" onclick="showAttendanceHourly()">Hourly</button>
                            <button class="attendance-tab" onclick="showAttendanceTermly()">Termly</button>
                        </div>
                        <div id="attendanceContent">
                            ${attendanceHTML || '<p style="text-align: center; padding: 20px;">No attendance records found</p>'}
                        </div>
                    </div>
                `;
            } else {
                const todayStr = new Date().toISOString().split('T')[0];
                const todayCount = Object.keys(attendanceData).filter(key => key.includes(todayStr)).length;
                
                content.innerHTML = `
                    <div class="attendance-page">
                        <h3 style="margin-bottom: 20px;">Attendance Overview</h3>
                        <div class="stats-grid">
                            <div class="stat-card">
                                <div class="stat-title">Today's Attendance</div>
                                <div class="stat-value">${todayCount}</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-title">Total Records</div>
                                <div class="stat-value">${Object.keys(attendanceData).length}</div>
                            </div>
                        </div>
                    </div>
                `;
            }
        }

        function getAttendanceCourseHTML() {
            const studentId = currentUser.reg;
            const coursesList = window.courses || courses;
            
            let totalClasses = 0;
            let totalAttended = 0;
            
            for (const [key, status] of Object.entries(attendanceData)) {
                if (key.startsWith(studentId) && !key.includes('_faculty') && !key.includes('_course') && !key.includes('_details')) {
                    totalClasses++;
                    if (status === 'present') {
                        totalAttended++;
                    }
                }
            }
            
            const attendancePercentage = totalClasses > 0 ? Math.round((totalAttended / totalClasses) * 100) : 0;
            
            return `
                <div class="course-list">
                    <div class="course-item">
                        <div class="course-header">
                            <h3>Overall Attendance</h3>
                        </div>
                        <div class="course-stats">
                            <span>Total Classes: ${totalClasses}</span>
                            <span>Attended: ${totalAttended}</span>
                            <span>Percentage: ${attendancePercentage}%</span>
                        </div>
                    </div>
                    ${coursesList.map(course => {
                        let courseClasses = 0;
                        let courseAttended = 0;
                        
                        for (const [key, status] of Object.entries(attendanceData)) {
                            if (key.startsWith(studentId) && !key.includes('_faculty') && !key.includes('_course') && !key.includes('_details')) {
                                courseClasses++;
                                if (status === 'present') {
                                    courseAttended++;
                                }
                            }
                        }
                        
                        const coursePercentage = courseClasses > 0 ? Math.round((courseAttended / courseClasses) * 100) : 0;
                        
                        return `
                            <div class="course-item">
                                <div class="course-header">
                                    <h3>${course.code} - ${course.name}</h3>
                                    <div class="course-faculty">Faculty: ${course.faculty}</div>
                                </div>
                                <div class="course-stats">
                                    <span>Classes: ${courseClasses}</span>
                                    <span>Attended: ${courseAttended}</span>
                                    <span>${coursePercentage}%</span>
                                </div>
                            </div>
                        `;
                    }).join('')}
                </div>
            `;
        }

        function showAttendanceCourse() {
            document.querySelectorAll('.attendance-tab').forEach(tab => tab.classList.remove('active'));
            event.target.classList.add('active');
            document.getElementById('attendanceContent').innerHTML = getAttendanceCourseHTML();
        }

        function showAttendanceHourly() {
            document.querySelectorAll('.attendance-tab').forEach(tab => tab.classList.remove('active'));
            event.target.classList.add('active');
            
            const studentId = currentUser.reg;
            
            const novemberDays = [
                { day: '19', weekday: 'Wed' }, { day: '20', weekday: 'Thu' }, { day: '21', weekday: 'Fri' },
                { day: '24', weekday: 'Mon' }, { day: '25', weekday: 'Tue' }, { day: '26', weekday: 'Wed' },
                { day: '27', weekday: 'Thu' }, { day: '28', weekday: 'Fri' }
            ];
            
            const html = `
                <div>
                    <div class="month-grid">
                        <button class="month-btn active">November</button>
                        <button class="month-btn">December</button>
                        <button class="month-btn">January</button>
                        <button class="month-btn">February</button>
                    </div>
                    <table class="attendance-table">
                        <thead>
                            <tr><th>Day</th><th>H1</th><th>H2</th><th>H3</th><th>H4</th><th>H5</th></tr>
                        </thead>
                        <tbody>
                            ${novemberDays.map(day => {
                                const date = `2025-11-${day.day.padStart(2, '0')}`;
                                return `
                                    <tr>
                                        <td>${day.day}-${day.weekday}</td>
                                        ${[1,2,3,4,5].map(hour => {
                                            const key = `${studentId}_${date}_${hour}`;
                                            const status = attendanceData[key] || 'unmarked';
                                            return `<td class="status-${status}">${getStatusSymbol(status)}</td>`;
                                        }).join('')}
                                    </tr>
                                `;
                            }).join('')}
                        </tbody>
                    </table>
                    <div class="status-buttons">
                        <span class="status-btn present"> Present</span>
                        <span class="status-btn absent"> Absent</span>
                        <span class="status-btn late"> Late</span>
                        <span class="status-btn letoff"> Let-off</span>
                        <span class="status-btn unmarked"> Unmarked</span>
                    </div>
                </div>
            `;
            
            document.getElementById('attendanceContent').innerHTML = html;
        }

        function showAttendanceTermly() {
            document.querySelectorAll('.attendance-tab').forEach(tab => tab.classList.remove('active'));
            event.target.classList.add('active');
            
            const studentId = currentUser.reg;
            
            const months = [
                { name: 'Nov', days: 30, year: 2025, monthNum: 11 },
                { name: 'Dec', days: 31, year: 2025, monthNum: 12 },
                { name: 'Jan', days: 31, year: 2026, monthNum: 1 }
            ];
            
            let totalAttended = 0;
            let totalClasses = 0;
            
            const monthData = months.map((month, index) => {
                let attended = 0;
                let total = 0;
                
                for (let day = 1; day <= month.days; day++) {
                    const date = `${month.year}-${month.monthNum.toString().padStart(2, '0')}-${day.toString().padStart(2, '0')}`;
                    for (let hour = 1; hour <= 5; hour++) {
                        const key = `${studentId}_${date}_${hour}`;
                        if (attendanceData[key]) {
                            total++;
                            totalClasses++;
                            if (attendanceData[key] === 'present') {
                                attended++;
                                totalAttended++;
                            }
                        }
                    }
                }
                
                const percent = total > 0 ? Math.round((attended / total) * 100) : 0;
                
                return {
                    sl: index + 1,
                    year: month.year,
                    month: month.name,
                    attended: attended.toFixed(1),
                    total: total.toFixed(1),
                    percent: percent
                };
            });
            
            const overallPercent = totalClasses > 0 ? Math.round((totalAttended / totalClasses) * 100) : 0;
            
            const html = `
                <div class="term-stats">
                    <div class="term-header">
                        <h3>Semester-6</h3>
                        <span>${overallPercent}%</span>
                    </div>
                    <div class="term-period">Term<br>19-11-2025 To 15-04-2026</div>
                    <table class="term-table">
                        <thead>
                            <tr><th>SI</th><th>Year</th><th>Month</th><th>Attendance</th><th>Total</th><th>%</th></tr>
                        </thead>
                        <tbody>
                            ${monthData.map(m => `
                                <tr>
                                    <td>${m.sl}</td>
                                    <td>${m.year}</td>
                                    <td>${m.month}</td>
                                    <td>${m.attended}</td>
                                    <td>${m.total}</td>
                                    <td>${m.percent}</td>
                                </tr>
                            `).join('')}
                            <tr>
                                <td colspan="3"><strong>Total</strong></td>
                                <td><strong>${totalAttended.toFixed(1)}</strong></td>
                                <td><strong>${totalClasses.toFixed(1)}</strong></td>
                                <td><strong>${overallPercent}</strong></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            `;
            
            document.getElementById('attendanceContent').innerHTML = html;
        }

        function getStatusSymbol(status) {
            switch(status) {
                case 'present': return '';
                case 'absent': return '';
                case 'late': return '';
                case 'letoff': return '';
                default: return '';
            }
        }

        // ==================== FEES PAGE ====================
        function showFees() {
            const content = document.getElementById('mainContent');
            content.innerHTML = `
                <div class="fees-page">
                    <div class="fees-tabs">
                        <button class="fees-tab active">Govt Account</button>
                        <button class="fees-tab">CoE Account</button>
                        <button class="fees-tab">Application Fee Account</button>
                    </div>
                    <div class="fees-subtabs">
                        <button class="fees-subtab active">Fees due</button>
                        <button class="fees-subtab">Payment History</button>
                    </div>
                    <div class="due-amount">
                        <h2>No Due Amounts</h2>
                        <p>Pay 0</p>
                        <button class="pay-btn" onclick="showNotification('Payment gateway coming soon', 'info')">Pay Now</button>
                    </div>
                </div>
            `;
        }

        function showFeePayment() {
            showFees();
        }

        function showOnlinePayment() {
            const content = document.getElementById('mainContent');
            content.innerHTML = `
                <div class="fees-page">
                    <div class="fees-subtabs">
                        <button class="fees-subtab active">Fee dues</button>
                        <button class="fees-subtab">Payment History</button>
                    </div>
                    <div class="no-dues">
                        No Fee Dues
                    </div>
                </div>
            `;
        }

        // ==================== LIBRARY PAGES ====================
        function showLibraryGo() {
            const content = document.getElementById('mainContent');
            content.innerHTML = `
                <div class="library-page">
                    <div class="library-tabs">
                        <button class="library-tab active" onclick="showLibraryAllBooks()">All books</button>
                        <button class="library-tab" onclick="showLibraryInHand()">In Hand</button>
                        <button class="library-tab" onclick="showLibraryHistory()">History</button>
                    </div>
                    <div class="library-search">
                        <input type="text" placeholder="Search books..." onkeyup="searchBooks(this.value)">
                    </div>
                    <div id="libraryBookList" class="book-list">
                        <div class="book-card">
                            <div class="book-title">State bank probability officers examination</div>
                            <div class="book-author">Author: T.S Jain</div>
                            <div class="book-details">Accession No: 1TB72752</div>
                        </div>
                        <div class="book-card">
                            <div class="book-title">Master Guide SSC CGL Pre Examination</div>
                            <div class="book-author">Author: Arihant Publications</div>
                            <div class="book-details">Accession No: 2TB28662</div>
                        </div>
                        <div class="book-card">
                            <div class="book-title">On Art And Literature</div>
                            <div class="book-author">Author: KailasapathyK.</div>
                            <div class="book-details">Accession No: 2TB3</div>
                        </div>
                        <div class="book-card">
                            <div class="book-title">American Universities and Colleges</div>
                            <div class="book-author">Author: Walter De Gruyter</div>
                            <div class="book-details">Accession No: 2TB4</div>
                        </div>
                    </div>
                </div>
            `;
        }

        function showLibraryInHand() {
            const content = document.getElementById('mainContent');
            content.innerHTML = `
                <div class="library-page">
                    <div class="library-tabs">
                        <button class="library-tab" onclick="showLibraryAllBooks()">All books</button>
                        <button class="library-tab active" onclick="showLibraryInHand()">In Hand</button>
                        <button class="library-tab" onclick="showLibraryHistory()">History</button>
                    </div>
                    <div class="no-dues">
                        No Books Found!
                    </div>
                </div>
            `;
        }

        function showLibraryHistory() {
            const content = document.getElementById('mainContent');
            content.innerHTML = `
                <div class="library-page">
                    <div class="library-tabs">
                        <button class="library-tab" onclick="showLibraryAllBooks()">All books</button>
                        <button class="library-tab" onclick="showLibraryInHand()">In Hand</button>
                        <button class="library-tab active" onclick="showLibraryHistory()">History</button>
                    </div>
                    <div class="no-dues">
                        No Books Found!
                    </div>
                </div>
            `;
        }

        function showLibraryAllBooks() {
            showLibraryGo();
        }

        function searchBooks(query) {
            const books = document.querySelectorAll('.book-card');
            books.forEach(book => {
                const title = book.querySelector('.book-title').textContent.toLowerCase();
                if (title.includes(query.toLowerCase())) {
                    book.style.display = 'block';
                } else {
                    book.style.display = 'none';
                }
            });
        }

        function showLibraryVisits() {
            const content = document.getElementById('mainContent');
            content.innerHTML = `
                <div class="visits-page">
                    <div class="visits-stats">
                        <div class="stat-box">
                            <div class="stat-number">0</div>
                            <div class="stat-label">This Year</div>
                        </div>
                        <div class="stat-box">
                            <div class="stat-number">0</div>
                            <div class="stat-label">This Month</div>
                        </div>
                        <div class="stat-box">
                            <div class="stat-number">0</div>
                            <div class="stat-label">This Week</div>
                        </div>
                    </div>

                    <div class="current-status">
                        <div class="status-indicator">OUT</div>
                        <div class="status-time">
                            <div class="date">Oct 13 Mon</div>
                            <div class="time">12.3 PM</div>
                        </div>
                    </div>

                    <h3 style="margin-bottom: 15px;">Recent Check IN / OUT</h3>
                    <div class="no-dues">
                        No data Found!
                    </div>
                </div>
            `;
        }

        // ==================== MY MENTOR PAGE ====================
        function showMyMentor() {
            const content = document.getElementById('mainContent');
            content.innerHTML = `
                <div class="mentor-page">
                    <h2>My Mentor</h2>
                    <p>No Mentor assigned!</p>
                </div>
            `;
        }

        // ==================== STUDENT TIMETABLE PAGE ====================
        function showStudentTimetable() {
            const content = document.getElementById('mainContent');
            const dates = ['11 Wed', '12 Thu', '13 Fri', '14 Sat', '15 Sun', '16 Mon', '17 Tue'];
            
            content.innerHTML = `
                <div class="timetable-page">
                    <div class="timetable-header">
                        <h3>Student Timetable</h3>
                        <span class="day-order">Day order: February 2026</span>
                    </div>
                    
                    <div class="date-grid">
                        ${dates.map(date => `<div class="date-box">${date}</div>`).join('')}
                    </div>

                    <div class="no-dues">
                        No data Found!
                    </div>
                </div>
            `;
        }

        // ==================== TUTORIALS PAGE ====================
        function showTutorials() {
            const content = document.getElementById('mainContent');
            content.innerHTML = `
                <div class="tutorials-page">
                    <h2 style="margin-bottom: 20px;">Tutorials</h2>
                    <div class="tutorials-search">
                        <input type="text" placeholder="Search Tutorials">
                    </div>
                    <div class="no-dues">
                        No data Found!
                    </div>
                </div>
            `;
        }

        // ==================== MY ACCOUNT PAGE ====================
        function showMyAccount() {
            showProfile();
        }

        // ==================== NOTIFICATION ====================
        function showNotification(message, type = 'info') {
            const notification = document.getElementById('notification');
            const icon = document.getElementById('notificationIcon');
            const msg = document.getElementById('notificationMessage');
            
            notification.className = `notification ${type}`;
            icon.textContent = type === 'success' ? '' : type === 'error' ? '' : '';
            msg.textContent = message;
            notification.classList.add('show');
            
            setTimeout(() => notification.classList.remove('show'), 3000);
        }

        // ==================== LOGOUT ====================
        function logout() {
            clearSession();
            currentUser = null;
            document.getElementById('loginPage').style.display = 'flex';
            document.getElementById('dashboard').classList.remove('active');
            document.getElementById('registerNumber').value = '';
            document.getElementById('password').value = '';
            document.getElementById('email').value = '';
            document.getElementById('adminPassword').value = '';
            showNotification('Logged out successfully', 'info');
        }

        // ==================== INITIALIZE ====================
        document.addEventListener('DOMContentLoaded', () => setRole('student'));
    </script>
</body>
</html>
